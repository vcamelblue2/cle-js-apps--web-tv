function e(e,t,i,s){Object.defineProperty(e,t,{get:i,set:s,enumerable:!0,configurable:!0})}var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},i={},s={},n=t.parcelRequire190d;null==n&&((n=function(e){if(e in i)return i[e].exports;if(e in s){var t=s[e];delete s[e];var n={id:e,exports:{}};return i[e]=n,t.call(n.exports,n,n.exports),n.exports}var r=Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}).register=function(e,t){s[e]=t},t.parcelRequire190d=n),n.register("e7lW4",function(t,i){e(t.exports,"CLE_FLAGS",function(){return n("4kMWh").CLE_FLAGS}),e(t.exports,"pass",function(){return n("4kMWh").pass}),e(t.exports,"f",function(){return n("4kMWh").f}),e(t.exports,"Use",function(){return n("4kMWh").Use}),e(t.exports,"Bind",function(){return n("4kMWh").Bind}),e(t.exports,"SmartAlias",function(){return n("4kMWh").SmartAlias}),e(t.exports,"LE_InitWebApp",function(){return n("4kMWh").LE_InitWebApp}),e(t.exports,"cle",function(){return n("4kMWh").cle}),e(t.exports,"str",function(){return n("4kMWh").str}),e(t.exports,"str_",function(){return n("4kMWh").str_}),e(t.exports,"html",function(){return n("4kMWh").html}),e(t.exports,"ComponentsRegistry",function(){return n("4kMWh").ComponentsRegistry}),n("4kMWh")}),n.register("4kMWh",function(t,i){e(t.exports,"CLE_FLAGS",function(){return r}),e(t.exports,"pass",function(){return l}),e(t.exports,"SmartAlias",function(){return C}),e(t.exports,"f",function(){return ea}),e(t.exports,"fArgs",function(){return ed}),e(t.exports,"Use",function(){return w}),e(t.exports,"ComponentsRegistry",function(){return eH}),e(t.exports,"Placeholder",function(){return D}),e(t.exports,"Bind",function(){return G}),e(t.exports,"RenderApp",function(){return q}),e(t.exports,"LE_LoadCss",function(){return er}),e(t.exports,"LE_InitWebApp",function(){return eo}),e(t.exports,"cle",function(){return el}),e(t.exports,"str",function(){return eh}),e(t.exports,"str_",function(){return ep}),e(t.exports,"input",function(){return ec}),e(t.exports,"clsIf",function(){return eu}),e(t.exports,"html",function(){return ef});var s=n("OHGR1");let r={LOG_DEBUG_ENABLED:!1,LOG_INFO_ENABLED:!1,LOG_WARNING_ENABLED:!0,PROPERTY_OPTIMIZATION:!0,REMOTE_HTML_V2_AUTOSTYLE:!0,COMPONENT_REGISTRY_BASE_HTML_EL:"div",DEFAULTS:{META:{FULL_OPTIMIZED:!1,PUSHBACK_AUTOMARK:!0}}},o={log:(...e)=>r.LOG_DEBUG_ENABLED&&console.log(...e)},a={log:(...e)=>r.LOG_INFO_ENABLED&&console.log(...e)},d={log:(...e)=>r.LOG_WARNING_ENABLED&&console.log(...e)},l=void 0,h=()=>void 0,p=(e,t,i)=>{Object.keys(e).forEach(s=>{i.includes(s)&&(t[s]=e[s])})},c=e=>{"function"==typeof e&&(e=e());let t="";return Object.keys(e).forEach(i=>{i.startsWith("::")?t+=i.substring(2)+":"+e[i]+";":t+=i.split(/(?=[A-Z])/).join("-").toLowerCase()+":"+e[i]+";"}),t},u=e=>e.split("-").map((e,t)=>0===t?e:e.charAt(0).toUpperCase()+e.substring(1)).join(""),m=e=>"function"==typeof e,_=(e,t)=>1===t.length?[e,t[0]]:_(e[t[0]],t.slice(1)),f=(e,t=[],i,s={expRetryObj:!0},n="",r=r,o,a,l=0)=>{try{s.result=e(...t),void 0!==o&&o(0===l,s.result)}catch(h){l<r?setTimeout(()=>f(e,t,i,s,n,r,o,a,l+1),Math.min(10*(l+1),r)):(d.log("CLE - WARNING! unable to execute after 5 retry! "+n),d.log(h),void 0!==a&&a(l,h,s.result))}return void 0!==i?i(()=>s.result):s},v=e=>{let t=k(e),{meta:i,...s}=e[t];return{[t]:s}};class g{constructor(e=()=>{},t=()=>{},i=()=>{},s,n,r){this.getter=e,this.setter=t,this.markAsChanged=i,this.cachingComparer="boolean"==typeof s&&!0===s?(e,t)=>e!==t:s,this.externalDeps=r,this.isExternal=void 0!==this.externalDeps&&this.externalDeps.length>0}}let C=(e,t)=>new g(ea(e,!0),ed("v")("("+e+" = v)",!0),l,t),y=(e="",t="",i="",s={})=>{if(e.includes("=>"))return y(...e.split("=>").map(e=>e.trim()),i,s);let n={};return"string"==typeof t&&(t=t.split(",").map(e=>e.trim())),t.forEach(t=>{var r;n["let_"+i+t]=new g(ea("@"+e+"."+t,!0),ed("v")("{ @"+e+"."+t+" = v; $._mark_"+e+"_as_changed(); return v }",!0),l,null===(r=s[t])||void 0===r||r)}),n};class b extends g{}let E=(e,t=()=>{},i=()=>{},s=()=>{},n,r)=>{if(!Array.isArray(e)&&e instanceof x){let i=e;t=$=>i.value,e=[e]}return new b(t,i,s,n,r,e)},O=e=>e instanceof b;class x{init(e,t,i,s){this.isAlias=e instanceof g,this.hasExternalDeps=this.isAlias&&void 0!==e.externalDeps&&e.externalDeps.length>0,this.oj_valueFunc=e,this.isAlias&&(e=e.getter),this.isFunc=m(e),this.setupRetriverFunc(),this._onGet=t,this._onSet=i,this._onDestroy=s,this._latestResolvedValue=void 0,this._valueFunc=e,this.__analyzeAndConnectDeps(),this.mustRetriveRealValue=!0,this.lastRetrivedRealValue=void 0;try{this._latestResolvedValue=this.__getRealVaule()}catch{}}__analyzeAndConnectDeps(){this.registeredDependency.forEach(e=>e()),this.registeredDependency=[],this.dependency=void 0,this.isFunc&&(this.dependency=W(this._valueFunc),a.log("analysis - dependency: ",this,this.dependency),this.registeredDependency=this.registerToDepsHelper(this,this.dependency,this.hasExternalDeps?this.oj_valueFunc.externalDeps:void 0))}destroy(e=!1){if(this.init(void 0,void 0,void 0),this.registerToDepsHelper=void 0,e)return this.removeAllOnChengedHandler();this._onDestroy&&this._onDestroy()}__getRealVaule(){return this.retriver_func()}get value(){try{this._onGet()}catch(e){d.log("CLE - WARNING: the onGet is undefined! (ERROR)",e,this)}return this.__getRealVaule()}set value(e){if(this.mustRetriveRealValue=!0,this.lastRetrivedRealValue=void 0,void 0===this._onSet){d.log("CLE - WARNING: the onSet is undefined! (ERROR)",this);return}if(O(e)&&(this.init(e,this._onGet,this._onSet,this._onDestroy),e=e.getter),this.isAlias)this.oj_valueFunc.setter(...this.executionContext.map(e=>e()),e),this.hasExternalDeps&&(o.log("fire use ext changed!!"),this.fireOnChangedSignal());else{this.isFunc=m(e),this.setupRetriverFunc(),this._valueFunc=e,this.__analyzeAndConnectDeps();let t=this.__getRealVaule();this._onSet(t,e,this),this.fireOnChangedSignal(),this._latestResolvedValue=t}}setupRetriverFunc(){r.PROPERTY_OPTIMIZATION?this.isFunc?this.retriver_func=()=>(this.mustRetriveRealValue&&(this.lastRetrivedRealValue=this._valueFunc(...this.executionContext.map(e=>e())),this.mustRetriveRealValue=!1),this.lastRetrivedRealValue):this.retriver_func=()=>this._valueFunc:this.retriver_func=this.isFunc?()=>this._valueFunc(...this.executionContext.map(e=>e())):()=>this._valueFunc}markAsChanged(){if(o.log("marked as changed!",this),this.mustRetriveRealValue=!0,this.lastRetrivedRealValue=void 0,void 0===this._onSet){d.log("CLE - WARNING: the onSet is undefined!",this);return}this.isAlias&&this.oj_valueFunc.markAsChanged(...this.executionContext.map(e=>e()));let e=this.__getRealVaule();this._onSet(e,this._valueFunc,this),this.isAlias&&void 0!==this.oj_valueFunc.cachingComparer?this.oj_valueFunc.cachingComparer(e,this._latestResolvedValue)?(this.fireOnChangedSignal(),this._latestResolvedValue=e):o.log("cached!"):(this.fireOnChangedSignal(),this._latestResolvedValue=e)}fireOnChangedSignal(){let e=this.__getRealVaule();this.onChangedHandlers.forEach(t=>t.handler(e,this._latestResolvedValue))}hasOnChangedHandler(e){return void 0!==this.onChangedHandlers.find(t=>t.who===e)}addOnChangedHandler(e,t){return this.hasOnChangedHandler(e)||this.onChangedHandlers.push({who:e,handler:t}),()=>this.removeOnChangedHandler(e)}removeOnChangedHandler(e){this.onChangedHandlers=this.onChangedHandlers.filter(t=>t.who!==e)}removeAllOnChengedHandler(){let e=this.onChangedHandlers;return this.onChangedHandlers=[],e}isCachable(){return this.isAlias&&void 0!==this.oj_valueFunc.cachingComparer}isCacheInvalid(e){return this.oj_valueFunc.cachingComparer(e,this._latestResolvedValue)}get asFunctions(){return[this,()=>this.value,e=>{this.value=e}]}constructor(e,t,i,s,n,r,o=!0){this.executionContext=(Array.isArray(n)?n:[n]).map(e=>m(e)?e:()=>e),this.registerToDepsHelper=r,this.onChangedHandlers=[],this.dependency=void 0,this.registeredDependency=[],this.mustRetriveRealValue=!0,this.lastRetrivedRealValue=void 0,this.setupRetriverFunc(),o&&this.init(e,t,i,s)}}class R{emit(...e){this.handlers.forEach(t=>t.handler(...e))}emitWaitResp(...e){return this.handlers.map(t=>t.handler(...e))}emitWaitFirstToResp(...e){for(let t of this.handlers){let i=t.handler(...e);if(void 0!==i)try{return{consumer:t.who.$this,response:i}}catch{return{consumer:t.who,response:i}}}}emitWaitRespCondition(e,...t){for(let i of this.handlers){let s=i.handler(...t);if(e(s))try{return{consumer:i.who.$this,response:s}}catch{return{consumer:i.who,response:s}}}}awaitSignalFired(e,t=()=>!0,i){let s;let n=()=>{void 0!==i&&(clearTimeout(s),s=void 0)};return new Promise((r,o)=>{i&&(s=setTimeout(()=>{o({error:"TIMEOUT"})},i)),this.addHandler(e,(...i)=>{(void 0===t||t(...i))&&(n(),this.removeHandler(e),r(...i))})})}hasHandler(e){return void 0!==this.handlers.find(t=>t.who===e)}addHandler(e,t){return this.hasHandler(e)||this.handlers.push({who:e,handler:t}),()=>this.removeHandler(e)}removeHandler(e){this.handlers=this.handlers.filter(t=>t.who!==e)}destroy(){let e=this.handlers.map(e=>e.who);return this.handlers=[],e}constructor(e,t){this.name=e,this.definition=t,this.handlers=[]}}(0,s._)(R,"getSignalProxy",e=>({emit:(...t)=>e.emit(...t),emitWaitResp:(...t)=>e.emitWaitResp(...t),emitWaitFirstToResp:(...t)=>e.emitWaitFirstToResp(...t),emitWaitRespCondition:(t,...i)=>e.emitWaitRespCondition(t,...i),emitLazy:(t=1,...i)=>setTimeout(()=>{e.emit(...i)},t),subscribe:(t,i)=>e.addHandler(t,i),unsubscribe:t=>e.removeHandler(t),signalFired:async(t=()=>!0,i)=>await e.awaitSignalFired({},t,i)}));class A{hasSignal(e){return void 0!==this.signals[e]}addSignal(e,t){return!this.hasSignal(e)&&(this.signals[e]=new R(e,t),this.proxy[e]=R.getSignalProxy(this.signals[e]),this.handlersToRegister[e]&&(Object.values(this.handlersToRegister[e]).forEach(({who:t,handler:i})=>{this.addSignalHandler(e,t,i)}),this.handlersToRegister[e]=void 0)),this.signals[e]}addSignalHandler(e,t,i){return this.hasSignal(e)?this.signals[e].addHandler(t,i):(void 0===this.handlersToRegister[e]&&(this.handlersToRegister[e]=[]),this.handlersToRegister[e].push({who:t,handler:i})),()=>this.signals[e].removeHandler(t)}getProxy(){return this.proxy}constructor(){this.signals={},this.handlersToRegister={},this.proxy={newSignal:(e,t="stream => void")=>this.addSignal(e,t),subscribe:(e,t,i)=>this.addSignalHandler(e,t,i),unsubscribe:(e,t)=>this.signals[e].removeHandler(t)}}}let w=(e,t,{strategy:i="merge",init:s,passed_props:n,inject:r}={},o=[])=>new H(e,t,{strategy:i,init:s,passed_props:n,inject:r},o);class H{_resolveComponentRedefinition(){let e=k(this.component),t=Object.assign({},this.component[e]);if(void 0!==this.redefinitions){if("override"===this.strategy)t={...t,...this.redefinitions};else if("merge"===this.strategy){let i=[],s=["id","ctx_id","ctx_ref_id","constructor","beforeInit","onInit","afterChildsInit","afterInit","onUpdate","onDestroy","oos"],n=["signals","dbus_signals","data","private:data","props","private:props","let","alias","handle","when","directives"],r=["s_css"],o=["on","on_s","on_a"],l=["def","private:def"],h=["let_","on_"];Object.entries(this.redefinitions).forEach(([e,a])=>{s.includes(e)?t[e]=a:n.includes(e)?(e in t?t[e]={...t[e]}:t[e]={},Object.entries(a).forEach(([i,s])=>{t[e][i]=s})):r.includes(e)?(e in t?t[e]={...t[e]}:t[e]={},Object.entries(a).forEach(([i,s])=>{let n=t[e][i];void 0!==n&&s[0]===j&&(s=[...n,...s]),t[e][i]=s.filter(e=>e!==j)})):o.includes(e)?(e in t?t[e]={...t[e]}:t[e]={},Object.entries(a).forEach(([i,s])=>{void 0===t[e]||i in t[e]?t[e][i]={...t[e][i]}:t[e][i]={},Object.entries(s).forEach(([s,n])=>{t[e][i][s]=n})})):l.includes(e)?(e in t?t[e]={...t[e]}:t[e]={},Object.entries(a).forEach(([i,s])=>{"function"==typeof s?t[e][i]=s:(void 0===t[e]||i in t[e]?t[e][i]={...t[e][i]}:t[e][i]={},Object.entries(s).forEach(([s,n])=>{t[e][i][s]=n}))})):i.includes(e)?d.log("CLE - WARNING!",e,"cannot be redefined!"):(h.map(t=>e.startsWith(t)).includes(!0)||d.log("CLE - WARNING! ACTUALLY",e,"is not supported in merge strategy! i simply FULL override it! assuming you can control the amount of override.."),t[e]=a)}),a.log("RESOLVED!",this.component[e],this.redefinitions,t)}}let i=this.inject||{},s=(e,t=0)=>{if("function"==typeof e||"string"==typeof e||e instanceof H)return e;{let n=k(e),r=e[n];if(eH.has(n))return e;if("function"==typeof r||"string"==typeof r||Array.isArray(r))return(Array.isArray(r)&&(r=r.map(e=>s(e,t+1))),0===t&&this.extraChilds.length>0)?Array.isArray(r)?{[n]:[...r,...this.extraChilds]}:{[n]:[r,...this.extraChilds]}:{[n]:r};let o=Object.assign({},e[n]),a=T(o);return null!==a&&(Array.isArray(o[a])?o[a]=[...o[a]]:o[a]=[o[a]],o[a]=o[a].map(e=>e instanceof I?e.getCheckedComponent(i[e.name]):s(e,t+1)).filter(e=>void 0!==e)),0===t&&this.extraChilds.length>0&&(null!==a?o[a]=[...o[a],...this.extraChilds]:o[L[0]]=[...this.extraChilds]),{[n]:o}}};return s({[e]:t})}cloneWithoutMeta(){let e;if(void 0!==this.redefinitions){let{meta:t,...i}=this.redefinitions;e=i}return new H(v(this.component),e,{strategy:this.strategy,init:this.init,passed_props:this.passed_props,inject:this.inject},this.extraChilds)}constructor(e,t,{strategy:i="merge",init:s,passed_props:n,inject:r}={},o=[]){this.component=e,this.init=s,this.passed_props=n,this.redefinitions=t,this.strategy=i,this.inject=r,this.extraChilds=Array.isArray(o)?o:[o],this.computedTemplate=this._resolveComponentRedefinition()}}let P=(...e)=>w(...e).computedTemplate;class S{build(e){let{prop:t,signal:i}=this.extractor.bind(void 0,e)();return{getter:E(t),setter:$=>e=>{t.value=e},signal:i}}constructor(e){e.includes(".")?this.extractor=$=>{let t=e.split("."),i=$;return e="",t.forEach((s,n)=>{0===n||(n===t.length-1?e=s:n<t.length-1&&(i=i[s]))}),{prop:i.getAsExternalProperty(e),signal:i.getAsExternalSignal(e+"Changed")}}:this.extractor=$=>({prop:$.getAsExternalProperty(e),signal:$.getAsExternalSignal(e+"Changed")})}}let j={},D=(e,{default_component:t,must_be_redefined:i=!1,forced_id:s,forced_ctx_id:n,replace_if_different:r=!0}={})=>new I(e,{default_component:t,must_be_redefined:i,forced_id:s,forced_ctx_id:n,replace_if_different:r});class I{getCheckedComponent(e){if(void 0===e){if(this.must_be_redefined)throw Error("Injected Component (Placeholder repl) must be redefined by contract!");return this.default_component}if("function"==typeof e||"string"==typeof e||e instanceof H)return e;let[t,i]=Object.entries(e)[0];if(!1!==this.replace_if_different)return{[t]:{...i,id:this.forced_id||i.id,ctx_id:this.forced_ctx_id||i.ctx_id}};if((void 0===this.forced_id||i.id===this.forced_private_id)&&(void 0===this.forced_ctx_id||i.ctx_id===this.forced_ctx_id))return e;throw Error("Injected Component (Placeholder repl) must have specific ID by contract")}constructor(e,{default_component:t,must_be_redefined:i=!1,forced_id:s,forced_ctx_id:n,replace_if_different:r=!0}={}){this.name=e,this.default_component=t,this.must_be_redefined=i,this.forced_id=s,this.forced_ctx_id=n,this.replace_if_different=r}}let L=["","=>","text","_",">>","view","contains","childs"],T=e=>{for(let t of L)if(t in e)return t;return null},k=e=>{e instanceof H&&(e=e.computedTemplate);let t=Object.entries(e);if(a.log(e,t),t.length>1)throw Error();let[i,s]=t[0];return i},W=(e,t=!1)=>{let i,s=t?e.getter.toString():e.toString(),n=s.match(/\$.this\.([_$a-zA-Z]+[0-9]*[.]?)+/g);n=null==n?void 0:n.map(e=>e.replace("$.this.","").split(".")[0]);let r=s.match(/\$.parent\.([_$a-zA-Z]+[0-9]*[.]?)+/g);r=null==r?void 0:r.map(e=>e.replace("$.parent.","").split(".")[0]);let o=s.match(/\$.scope\.([_$a-zA-Z]+[0-9]*[.]?)+/g);o=null==o?void 0:o.map(e=>e.replace("$.scope.","").split(".")[0]);let a=s.match(/\$.le\.([_$a-zA-Z]+[0-9]*[.]?)+/g);a=null==a?void 0:a.map(e=>e.replace("$.le.","").split(".").slice(0,2));let d=s.match(/\$.ctx\.([_$a-zA-Z]+[0-9]*[.]?)+/g);d=null==d?void 0:d.map(e=>e.replace("$.ctx.","").split(".").slice(0,2));let l=s.match(/\$.ref\.([_$a-zA-Z]+[0-9]*[.]?)+/g);l=null==l?void 0:l.map(e=>e.replace("$.ref.","").split(".").slice(0,2));let h=s.match(/\$.meta\.([_$a-zA-Z]+[0-9]*[.]?)+/g);h=null==h?void 0:h.map(e=>e.replace("$.meta.","").split(".")[0]);let p=s.match(/\$.([_$a-zA-Z]+[0-9]*[.]?)+/g);return null==p||p.map(e=>e.split(".").filter(e=>"$"!==e)).forEach(e=>{["oos","this","parent","scope","le","ctx","ref","meta","u"].includes(e[0])||(void 0!==o?o.push(e[0]):o=[e[0]])}),t&&(i=[...e.externalDeps]),{$this_deps:n,$parent_deps:r,$scope_deps:o,$le_deps:a,$ctx_deps:d,$ref_deps:l,$meta_deps:h,$external_deps:i}},z=(e,t=0)=>new Proxy(e,{get:(e,t,i)=>{let s=e[t];return s instanceof x?s.value:s},set:function(e,t,i){let s=e[t];if(s instanceof x)return s.value=i,!0}}),M=(e,t=0)=>new Proxy(e,{get:(e,t,i)=>{if(t in e){let i=e[t];return i instanceof x?i.value:i}if(void 0!==e.scope&&t in e.scope)return e.scope[t];throw Error("Property Not Found")},set:function(e,t,i){if(t in e){let s=e[t];if(s instanceof x)return s.value=i,!0}else if(void 0!==e&&t in e.scope)return e.scope[t]=i,!0;else throw Error("Property Not Found")}}),N=e=>{let t=(e,i,s=0,n=!1)=>{if(0===s&&(n=e.meta_options.noMetaInScope),void 0===e||void 0===e.$this)return{};if(0===s&&e.meta_options.noThisInScope)return t(e.parent,i,s+1,n);if(i in(e.properties||{}))return e.properties;if(!n&&i in(e.meta||{}))return e.meta;if(!e.meta_options.isNewScope)return t(e.parent,i,s+1,n);throw Error("Properties cannot be found in this scope..blocked scope?")};return new Proxy({},{has:(i,s)=>(i=t(e,s),s in i),get:(i,s,n)=>{let r=t(e,s)[s];return r instanceof x?r.value:r},set:function(i,s,n){let r=t(e,s)[s];if(r instanceof x)return r.value=n,!0}})},F=e=>{let t=(e,i,s=0)=>{var n;return void 0===e?{}:i in((null===(n=e.convertedDefinition)||void 0===n?void 0:n.childsRef)||{})?e.childsRefPointers:t(e.parent,i,s+1)};return new Proxy({},{get:(i,s,n)=>{let r=t(e,s)[s];return Array.isArray(r)?r.map(e=>e.$this.this):r.$this.this},set:function(e,t,i){}})};class V{constructor(){this.proxy=new Proxy(this,{get:function(e,t,i){return e[t].$this.this}})}}class B{constructor(e,t,i){this.bindFunc=e,this.remap=t,this.event=i}}let U=(e,{remap:t,event:i}={})=>new B(e,t,i),G=(e,...t)=>m(e)?U(e,...t):"string"==typeof e?C(e,...t):void 0;class Z{static generate(){return this.__counter>=Number.MAX_SAFE_INTEGER&&(this.__counter=0,this.__modifier_on_max+="-"),"t-le-id-"+this.__counter+++this.__modifier_on_max}static reset(){this.__counter=0}}(0,s._)(Z,"__counter",0),(0,s._)(Z,"__modifier_on_max","");class Y{static generate(){return this.__counter>=Number.MAX_SAFE_INTEGER&&(this.__counter=0,this.__modifier_on_max+="-"),"cle-"+this.__counter+++this.__modifier_on_max}static reset(){this.__counter=0}}(0,s._)(Y,"__counter",0),(0,s._)(Y,"__modifier_on_max","");let q=(e,t)=>{let i=new J(e,t);return i.initAndRenderize(),i},K=(e,t,i,...s)=>{let n=t(e.$this.this,i,...s);Array.isArray(n)||(n=[n]);let r=n.map(t=>Q.componentFactory(e,t,e.$le,e.$dbus));return r.map(e=>e.buildSkeleton()),r.map(e=>e.create()),r};class J{initAndRenderize(){this.buildSkeleton(),this.components_root.create()}buildSkeleton(){this.components_root=Q.componentFactory(this.html_root,this.oj_definition,this.$le,this.$dbus),this.components_root.buildSkeleton()}destroy(){this.components_root.destroy()}constructor(e,t){(0,s._)(this,"html_root",void 0),(0,s._)(this,"oj_definition",void 0),(0,s._)(this,"components_root",void 0),(0,s._)(this,"$le",void 0),(0,s._)(this,"$dbus",void 0),(0,s._)(this,"$cssEngine",void 0),this.html_root=e,this.oj_definition=t,this.$le=new V,this.$dbus=new A}}class Q{getMy$ctx(){var e;return this.isA$ctxComponent?null!==(e=this.$ctx)&&void 0!==e?e:new V:void 0!==this.parent&&this.parent instanceof Q?this.parent.getMy$ctx():void 0}getMy$ctxRoot(){return this.isA$ctxComponent?this:void 0!==this.parent&&this.parent instanceof Q?this.parent.getMy$ctxRoot():void 0}getMy$ctxParentRoot(){if(void 0!==this.parent&&this.parent instanceof Q)return this.getMy$ctxRoot().parent.getMy$ctxRoot()}getMyFullMeta(){return this.isMyParentHtmlRoot?this.meta:this.meta_options.isNewScope?(a.log("Component meta blocked scope:",this.meta,this.oj_definition,this),this.meta):void 0!==this.parent&&this.parent instanceof Q?{...this.parent.getMyFullMeta(),...this.meta}:{}}getMy$meta(){return this.isMyParentHtmlRoot?(a.log("Component meta:",this.meta,this.oj_definition,this),z(this.meta)):this.meta_options.isNewScope?(a.log("Component meta blocked scope:",this.meta,this.oj_definition,this),z(this.meta)):void 0!==this.parent&&this.parent instanceof Q?(a.log("Parernt meta:",this.parent.meta,this.oj_definition,this),z(this.getMyFullMeta())):void 0}get$ScopedPropsOwner(e,t=0,i=!1,s=!1){if(0===t&&(i=this.meta_options.noMetaInScope),void 0===this.parent||!(this.parent instanceof Q))return[this,!0];if(0===t&&this.meta_options.noThisInScope)return this.parent.get$ScopedPropsOwner(e,t+1,i,s);if(e in this.properties||s&&e in this.signals)return[this,!0];if(!i&&e in this.meta)return[this,!1];if(!this.meta_options.isNewScope)return this.parent.get$ScopedPropsOwner(e,t+1,i,s);throw Error("Properties cannot be found in this scope..blocked scope?")}get$ScopedSignalOwner(e,t=0){if(void 0===this.parent||!(this.parent instanceof Q))return[this,!0];if(0===t&&this.meta_options.noThisInScope)return this.parent.get$ScopedSignalOwner(e,t+1);if(e in this.signals)return[this,!0];if(!this.meta_options.isNewScope)return this.parent.get$ScopedSignalOwner(e,t+1);throw Error("Signal cannot be found in this scope..blocked scope?")}defineAndRegisterId(){this.id=this.convertedDefinition.id,this.ctx_id=this.convertedDefinition.ctx_id,this.ctx_ref_id=this.convertedDefinition.ctx_ref_id,void 0!==this.id&&(this.$le[this.id]=this,this.$ctx[this.id]=this),void 0!==this.ctx_id&&(this.$ctx[this.ctx_id]=this),this.isMyParentHtmlRoot&&(this.$le.root=this),this.isA$ctxComponent&&(this.$ctx.root=this),this.isA$ctxComponent&&!this.isMyParentHtmlRoot&&void 0!==this.ctx_ref_id&&(this.parent.$ctx[this.ctx_ref_id]=this)}buildSkeleton(){this.buildHtmlPointerElement(),this.buildPropertiesRef(),this.buildChildsSkeleton()}buildHtmlPointerElement(){if(this.isObjComponent)this.html_pointer_element=document.createElement("leobj"),this.meta_options.hasViewChilds&&(this.isMyParentHtmlRoot?this.parent.appendChild(this.html_pointer_element):this.parent.html_pointer_element.appendChild(this.html_pointer_element));else if(this.isPlaceholderPointerComponent){this.html_pointer_element=document.createComment("cleptr"),this.isMyParentHtmlRoot?this.parent.appendChild(this.html_pointer_element):this.parent.html_pointer_element.appendChild(this.html_pointer_element);return}else this.html_pointer_element=document.createElement(this.htmlElementType),this.isMyParentHtmlRoot?this.parent.appendChild(this.html_pointer_element):this.parent.html_pointer_element.appendChild(this.html_pointer_element);this.html_pointer_element.setAttribute(this.t_uid,"")}buildChildsSkeleton(){var e;this.childs=(null===(e=this.convertedDefinition.childs)||void 0===e?void 0:e.map(e=>Q.componentFactory(this,e,this.$le,this.$dbus)))||[],this.childs.forEach(e=>e.buildSkeleton())}buildPropertiesRef(){var e,t;this.properties.el=this.html_pointer_element,this.properties.parent=null===(e=this.parent)||void 0===e?void 0:null===(t=e.$this)||void 0===t?void 0:t.this,this.properties.comp_id=this.id,this.properties.comp_ctx_id=this.ctx_id,this.properties.comp_ctx_ref_id=this.ctx_ref_id,this.properties.t_uid=this.t_uid,this.properties.getOos=()=>this.$oos,this.properties.getAsExternalProperty=e=>{let t=this.properties[e];if(t instanceof x)return t},this.properties.getAsExternalSignal=e=>{let t=this.signals[e];if(t instanceof R)return R.getSignalProxy(t)},this.properties.subscribe=(e,t,i,s=!1)=>{if(e in this.signals)return this.signals[e].addHandler(t,i);if(e.includes(".")){if(e.startsWith("dbus."))return this.$dbus.addSignalHandler(e.slice(5),t,i);if(e.startsWith("le.")){let[s,n,r]=e.split(".");return this.$le[n].signals[r].addHandler(t,i)}if(e.startsWith("ctx.")){let[s,n,r]=e.split(".");return this.$ctx[n].signals[r].addHandler(t,i)}if(e.startsWith("ref.")){let[s,n,r]=e.split("."),o=this.getChildsRefOwner(n).childsRefPointers[n];return Array.isArray(o)?o.map(e=>e.signals[r].addHandler(t,i)):o.signals[r].addHandler(t,i)}}else if(s){let[s,n]=this.get$ScopedSignalOwner(e);return s.signals[e].addHandler(t,i)}throw Error("Signal does not exists")},this.properties.subscribeAsync=async(e,t,i)=>new Promise((s,n)=>{let r=(o=0)=>{try{let n=this.signals[e].addHandler(t,i);s(n)}catch{o<5?setTimeout(()=>r(o++),Math.min(1*(o+1),5)):(d.log("CLE - WARNING! unable to subscribe to the signal!"),n("Signal does not exists"))}};r()}),this.properties.unsubscribe=(e,t,i=!1)=>{if(e in this.signals)this.signals[e].removeHandler(t);else if(e.includes(".")){if(e.startsWith("dbus."))return this.$dbus.signals[e.slice(5)].removeHandler(t);if(e.startsWith("le.")){let[i,s,n]=e.split(".");return this.$le[s].signals[n].removeHandler(t)}if(e.startsWith("ctx.")){let[i,s,n]=e.split(".");return this.$ctx[s].signals[n].removeHandler(t)}if(e.startsWith("ref.")){let[i,s,n]=e.split("."),r=this.getChildsRefOwner(s).childsRefPointers[s];return Array.isArray(r)?r.map(e=>e.signals[n].removeHandler(t)):r.signals[n].removeHandler(t)}}else if(i){let[i,s]=this.get$ScopedSignalOwner(e);return i.signals[e].removeHandler(t)}throw Error("Signal does not exists")},this.properties.editRefVal=new Proxy({},{get:(e,t)=>e=>{e(this.$this.this[t]),this.properties["_mark_"+t+"_as_changed"]()},set:function(){}}),this.properties.editArrRefVal=new Proxy({},{get:(e,t)=>e=>{e(this.$this.this[t]),this.$this.this[t]=[...this.$this.this[t]]},set:function(){}}),this.registerAsChildsRef(),this.$parent=this.parent instanceof Q?z(this.parent.properties):void 0,this.$scope=N(this),this.$ref=F(this),this.$this=M({this:z(this.properties),parent:this.$parent,scope:this.$scope,le:this.$le.proxy,ctx:this.$ctx.proxy,dbus:this.$dbus.proxy,meta:this.$meta,ref:this.$ref,oos:new Proxy({},{get:(e,t,i)=>this.$oos[t],set:(e,t,i)=>(this.$oos[t]=i,!0)}),u:this.getUtilsProxy()})}getUtilsProxy(){return z({newSignal:(e,t="stream => void")=>{let i=new R(e,t);this.signals[e]=i,this.properties[e]=R.getSignalProxy(i)},changed:((e,...t)=>{for(let i of t)e["_mark_"+i+"_as_changed"]()}).bind(void 0,this.$scope),propCondition:(e,t,i=e=>null!=e,s,n=5)=>{let r,o={},a=()=>{void 0!==s&&(clearTimeout(r),r=void 0)};return new Promise((d,h)=>{s&&(r=setTimeout(()=>{h({error:"TIMEOUT"})},s)),f(()=>{let s=e.bind(void 0,this.$this)();if(null==s)throw Error("Cannot Find Scope");{let e=s[t];if(m(i)&&i(e)||Array.isArray(i)&&i.includes(e))a(),d(e);else{let e=s.subscribe(t+"Changed",o,t=>{(m(i)&&i(t)||Array.isArray(i)&&i.includes(t))&&(e(),a(),d(t))})}}},l,l,l,"Cannot connect to CLE Prop",n,l,(...e)=>(a(),h(e)))})},signalFired:(e,t,i=e=>!0,s,n=5)=>new Promise((r,o)=>{f(()=>{let n=e.bind(void 0,this.$this)();if(null==n)throw Error("Cannot Find Scope");n[t].signalFired(i,s).then((...e)=>r(...e)).catch(e=>o(e))},l,l,l,"Cannot connect to CLE Signal",n,l,(...e)=>o(e))}),getCleElementByDom:e=>{if("string"==typeof e&&(e=document.querySelector(e)),null===e)throw Error("Null-Query-Sel");return Object.values(this.$le).find(t=>t instanceof Q&&t.html_pointer_element===e).$this.this},getCleElementsByDom:(...e)=>{if(1===e.length&&"string"==typeof e[0]&&(e=[...document.querySelectorAll(e)]),0===e.length)throw Error("Null-Query-Sel");return Object.values(this.$le).filter(t=>t instanceof Q&&e.includes(t.html_pointer_element)).map(e=>e.$this.this)},getChildsRef:e=>{let t=this.getChildsRefOwner(e);return Array.isArray(t.childsRefPointers[e])?t.childsRefPointers[e].map(e=>e.$this.this):t.childsRefPointers[e].$this.this},getSubChildRef:e=>{let t=[...this.childs];for(let i of t)try{if(i instanceof Q){if(i.convertedDefinition.name===e)return i.$this.this;i.childs.forEach(e=>t.push(e))}else i instanceof es&&i.childs.forEach(e=>t.push(e))}catch{}return null},getSubChildsRef:(e,t=0)=>{let i=[...this.childs],s=[];for(let n of i)try{if(n instanceof Q){if(n.convertedDefinition.name===e){if(s.push(n.$this.this),t>0&&s.length>=t)break}else n.childs.forEach(e=>i.push(e))}else n instanceof es&&n.childs.forEach(e=>i.push(e))}catch{}return s},lazyRender:(e,{afterCreate:t,beforeDestroy:i,afterDestroy:s,auto:n=!1}={},...r)=>{n&&this.destroyDynamicChilds(void 0,!1,!1),i&&(this.dynamicChildsBeforeDestroy=i),s&&(this.dynamicChildsBeforeDestroy=s);let o=K(this,e,this.dynamicChildsState,...r);return this.dynamicChilds=this.dynamicChilds.concat(o),void 0!==t&&setTimeout(()=>{t()},10),o.map(e=>e.$this)},getLazyRenderState:()=>this.dynamicChildsState,clearLazyRender:(e,t=!1,i=!1)=>{this.destroyDynamicChilds(e,t,i)},newConnectedSubRenderer:(e,t,i=!1,s="append")=>(void 0===e&&(e=this.html_pointer_element),ee.SubRendererComponentFactory(this,e,t,i,s))})}getChildsRefOwner(e){return e in(this.convertedDefinition.childsRef||{})?this:this.isMyParentHtmlRoot?void 0:this.parent.getChildsRefOwner(e)}registerAsChildsRef(){let e=this.convertedDefinition.name;if(void 0!==e){let t=this.getChildsRefOwner(e);void 0!=t?void 0===t.childsRefPointers[e]?t.childsRefPointers[e]="multi"===t.convertedDefinition.childsRef[e]?[this]:this:t.childsRefPointers[e]=Array.isArray(t.childsRefPointers[e])?[...t.childsRefPointers[e],this]:this:d.log("CLE Warning - Cannot find a ref owner")}}unregisterAsChildsRef(){let e=this.convertedDefinition.name;if(void 0!==e){let t=this.getChildsRefOwner(e);void 0!==t?void 0!==t.childsRefPointers[e]&&(t.childsRefPointers[e]=Array.isArray(t.childsRefPointers[e])?t.childsRefPointers[e].filter(e=>e!==this):void 0):d.log("CLE Warning - Cannot find a ref owner")}}create(){var e,t,i;if(void 0!==this.convertedDefinition.directives&&(Object.entries(this.convertedDefinition.directives).forEach(([e,t])=>{Object.entries(t).forEach(([e,t])=>{e in this.directives?this.directives[e].push(t):this.directives[e]=[t]})}),this.directives_hooks_destructors=[]),void 0!==this.convertedDefinition.checked_deps&&Object.entries(this.convertedDefinition.checked_deps).forEach(([e,t])=>{for(let i of t)if(!(i in this.$this[e]))throw Error(`Unsatisfied Dep! ${e}: ${i}`)}),void 0!==this.convertedDefinition.oos&&(this.$oos=m(this.convertedDefinition.oos)?this.convertedDefinition.oos.bind(this.$this,this.$this)():this.convertedDefinition.oos),void 0!==this.convertedDefinition.handle&&Object.entries(this.convertedDefinition.handle).forEach(([e,t])=>{if(m(t))this.html_pointer_element[e]=(...e)=>t.bind(void 0,this.$this,...e)(),this.handlerRemover.push(()=>{this.html_pointer_element[e]=void 0});else if("object"==typeof t){let i=t.if,s=t.use,n=t.else_use;if(void 0!==i){let t=()=>{this.html_pointer_element[e]=void 0},r=void 0===n?t=>{t?this.html_pointer_element[e]=(...e)=>s.bind(void 0,this.$this,...e)():this.html_pointer_element[e]=void 0}:t=>{t?this.html_pointer_element[e]=(...e)=>s.bind(void 0,this.$this,...e)():this.html_pointer_element[e]=(...e)=>n.bind(void 0,this.$this,...e)()},o=new x(l,l,l,l,()=>this.$this,(e,i)=>{var s,n,r,o,a,d;let h=[];return null===(s=i.$this_deps)||void 0===s||s.forEach(i=>{var s;let n=null===(s=this.properties[i])||void 0===s?void 0:s.addOnChangedHandler(e,()=>e.markAsChanged());n&&h.push(()=>{n(),t()})}),null===(n=i.$parent_deps)||void 0===n||n.forEach(i=>{var s;let n=null===(s=this.parent.properties[i])||void 0===s?void 0:s.addOnChangedHandler(e,()=>e.markAsChanged());n&&h.push(()=>{n(),t()})}),null===(r=i.$scope_deps)||void 0===r||r.forEach(i=>{var s;let[n,r]=this.get$ScopedPropsOwner(i),o=null===(s=r?n.properties[i]:n.meta[i])||void 0===s?void 0:s.addOnChangedHandler(e,()=>e.markAsChanged());o&&h.push(()=>{o(),t()})}),null===(o=i.$le_deps)||void 0===o||o.forEach(i=>{let s;f(()=>{s=this.$le[i[0]].properties[i[1]].addOnChangedHandler(e,()=>e.markAsChanged())},l,l,l,"Cannot connect to CLE Obj by Id",5),h.push((...e)=>{s(...e),t()})}),null===(a=i.$ctx_deps)||void 0===a||a.forEach(i=>{let s;f(()=>{s=this.$ctx[i[0]].properties[i[1]].addOnChangedHandler(e,()=>e.markAsChanged())},l,l,l,"Cannot connect to CLE Obj by Ctx Id",5),h.push((...e)=>{s(...e),t()})}),null===(d=i.$ref_deps)||void 0===d||d.forEach(i=>{let s;f(()=>{let t=this.getChildsRefOwner(i[0]).childsRefPointers[i[0]];if(Array.isArray(t))throw Error("Cannot Bind to multi-ref child");s=t.properties[i[1]].addOnChangedHandler(e,()=>e.markAsChanged())},l,l,l,"Cannot connect to CLE Obj by Ref Name",5),h.push(()=>{s(),t()})}),h},!1);this.handlerRemover.push(()=>o.destroy(!0)),setTimeout(()=>{o.init(i,h,r),o.markAsChanged()},10)}}}),void 0!==this.convertedDefinition.when_event_listener&&Object.entries(this.convertedDefinition.when_event_listener).forEach(([e,t])=>{if("object"==typeof t){let{handler:i,options:s}=t,n=this.html_pointer_element.addEventListener(e,(...e)=>i.bind(void 0,this.$this,...e)(),s);this.handlerRemover.push(n)}else if("function"==typeof t){let i=this.html_pointer_element.addEventListener(e,(...e)=>t.bind(void 0,this.$this,...e)());this.handlerRemover.push(i)}}),void 0!==this.convertedDefinition.data&&(Object.entries(this.convertedDefinition.data).forEach(([e,t])=>{this.properties[e]=new x(l,l,l,l,()=>this.$this,(e,t,i=[])=>{var s,n,r,o,a,d;let h=[];return null===(s=t.$this_deps)||void 0===s||s.forEach(t=>{var i,s;let n=null===(i=this.properties[t])||void 0===i?void 0:null===(s=i.addOnChangedHandler)||void 0===s?void 0:s.call(i,e,()=>e.markAsChanged());n&&h.push(n)}),null===(n=t.$parent_deps)||void 0===n||n.forEach(t=>{var i;let s=null===(i=this.parent.properties[t])||void 0===i?void 0:i.addOnChangedHandler(e,()=>e.markAsChanged());s&&h.push(s)}),null===(r=t.$scope_deps)||void 0===r||r.forEach(t=>{var i;let[s,n]=this.get$ScopedPropsOwner(t),r=null===(i=n?s.properties[t]:s.meta[t])||void 0===i?void 0:i.addOnChangedHandler(e,()=>e.markAsChanged());r&&h.push(r)}),null===(o=t.$le_deps)||void 0===o||o.forEach(t=>{let i;f(()=>{i=this.$le[t[0]].properties[t[1]].addOnChangedHandler(e,()=>e.markAsChanged())},l,l,l,"Cannot connect to CLE Obj by Id",5),h.push((...e)=>i(...e))}),null===(a=t.$ctx_deps)||void 0===a||a.forEach(t=>{let i;f(()=>{i=this.$ctx[t[0]].properties[t[1]].addOnChangedHandler(e,()=>e.markAsChanged())},l,l,l,"Cannot connect to CLE Obj by Ctx Id",5),h.push((...e)=>i(...e))}),null===(d=t.$ref_deps)||void 0===d||d.forEach(t=>{let i;f(()=>{let s=this.getChildsRefOwner(t[0]).childsRefPointers[t[0]];if(Array.isArray(s))throw Error("Cannot Bind to multi-ref child");i=s.properties[t[1]].addOnChangedHandler(e,()=>e.markAsChanged())},l,l,l,"Cannot connect to CLE Obj by Ref Name",5),h.push(()=>i())}),null==i||i.forEach(t=>{let i=null==t?void 0:t.addOnChangedHandler(e,()=>e.markAsChanged());i&&h.push(i)}),h},!1);let i=e+"Changed";this.signals[i]=new R(i,"stream => (newValue: any, oldValue: any) - property change signal"),this.properties["_mark_"+e+"_as_changed"]=()=>this.properties[e].markAsChanged()}),a.log("Parsed data definition: ",this,this.signals,this.properties)),void 0!==this.convertedDefinition.signals&&(Object.entries(this.convertedDefinition.signals).forEach(([e,t])=>{let i=new R(e,t);this.signals[e]=i,this.properties[e]=R.getSignalProxy(i)}),a.log("Parsed signals definition: ",this,this.signals,this.properties)),void 0!==this.convertedDefinition.dbus_signals&&Object.entries(this.convertedDefinition.dbus_signals).forEach(([e,t])=>{this.$dbus.addSignal(e,t)}),void 0!==this.convertedDefinition.def&&Object.entries(this.convertedDefinition.def).forEach(([e,t])=>{if(m(t)){this.properties[e]=(...e)=>t.bind(void 0,this.$this,...e)();let i=W(t);this.defDeps[e]=i}else this.properties[e]={},Object.entries(t).forEach(([t,i])=>{this.properties[e][t]=(...e)=>i.bind(void 0,this.$this,...e)();let s=W(i);this.defDeps[e+"."+t]=s}),this.properties[e]=z(this.properties[e])}),[this.convertedDefinition.on,this.convertedDefinition.on_s].forEach(e=>{void 0!==e&&(a.log("Found on/on_s/on_a definition",this),Object.entries(e).forEach(([e,t])=>{"this"===e?Object.entries(t).forEach(([e,t])=>{let i=this.signals[e].addHandler(this,(...e)=>t.bind(void 0,this.$this,...e)());this.signalsHandlerRemover.push(i)}):"parent"===e?Object.entries(t).forEach(([e,t])=>{let i=this.parent.signals[e].addHandler(this,(...e)=>t.bind(void 0,this.$this,...e)());this.signalsHandlerRemover.push(i)}):"scope"===e?Object.entries(t).forEach(([e,t])=>{let i=this.get$ScopedPropsOwner(e,l,l,!0)[0].signals[e].addHandler(this,(...e)=>t.bind(void 0,this.$this,...e)());this.signalsHandlerRemover.push(i)}):"dbus"===e?Object.entries(t).forEach(([e,t])=>{let i=this.$dbus.addSignalHandler(e,this,(...e)=>t.bind(void 0,this.$this,...e)());this.signalsHandlerRemover.push(i)}):"le"===e?Object.entries(t).forEach(([e,i])=>{Object.entries(i).forEach(([i,s])=>{let n=(r=0)=>{try{let t=this.$le[e].signals[i].addHandler(this,(...e)=>s.bind(void 0,this.$this,...e)());this.signalsHandlerRemover.push(t)}catch{r<5?setTimeout(()=>n(r++),Math.min(1*(r+1),5)):d.log("CLE - WARNING! unable to connect to the signal! -> ",this,t)}};n()})}):"ctx"===e?Object.entries(t).forEach(([e,i])=>{Object.entries(i).forEach(([i,s])=>{let n=(r=0)=>{try{let t=this.$ctx[e].signals[i].addHandler(this,(...e)=>s.bind(void 0,this.$this,...e)());this.signalsHandlerRemover.push(t)}catch{r<5?setTimeout(()=>n(r++),Math.min(1*(r+1),5)):d.log("CLE - WARNING! unable to connect to the signal! -> ",this,t)}};n()})}):"ref"===e&&Object.entries(t).forEach(([e,i])=>{Object.entries(i).forEach(([i,s])=>{let n=(r=0)=>{try{let t=this.getChildsRefOwner(e).childsRefPointers[e];if(Array.isArray(t))t.forEach(e=>{let t=e.signals[i].addHandler(this,(...e)=>s.bind(void 0,this.$this,...e)());this.signalsHandlerRemover.push(t)});else{let t=this.getChildsRefOwner(e).childsRefPointers[e].signals[i].addHandler(this,(...e)=>s.bind(void 0,this.$this,...e)());this.signalsHandlerRemover.push(t)}}catch{r<5?setTimeout(()=>n(r++),Math.min(1*(r+1),5)):d.log("CLE - WARNING! unable to connect to the signal! -> ",this,t)}};n()})})}))}),void 0!==this.convertedDefinition.data&&Object.entries(this.convertedDefinition.data).forEach(([e,t])=>{this.properties[e].init(t,()=>o.log(e,"getted!"),(t,i,s)=>{o.log(e,"setted!",this),s.isCachable()?s.isCacheInvalid(t)&&this.signals[e+"Changed"].emit(t,this.properties[e]._latestResolvedValue):this.signals[e+"Changed"].emit(t,this.properties[e]._latestResolvedValue)}),o.log("Parser, data initialized: ",this,this.properties)}),void 0!==this.convertedDefinition.attrs){o.log("Found attrs: ",this.convertedDefinition.attrs);let e={};Object.entries(this.convertedDefinition.attrs).forEach(([t,i])=>{let s=t=>{if(o.log("Parsing attr: ",t,i),t.includes("."))d.log("CLE - WARNING! ATTRS does not support '.' property navigation!");else{var s,n,r,h,p,u,_,v,g,C,y,b,E,O,x,R,A,w,H,P,S,j,D;if("style"===t){let e=e=>"object"==typeof e?c(e):e,a=t=>{var i;let s=m(t)?t.bind(void 0,this.$this)():t;null==s?this.html_pointer_element.hasAttribute("style")&&this.html_pointer_element.removeAttribute("style"):this.html_pointer_element.setAttribute("style",e(s).toString()),null===(i=this.singlePropStyleRecomputeHooks)||void 0===i||i.forEach(e=>null==e?void 0:e())};if(m(i)){let e=W(i);o.log("Attr static deps analysis: ",e),null===(s=e.$this_deps)||void 0===s||s.forEach(e=>{var s;let n=null===(s=this.properties[e])||void 0===s?void 0:s.addOnChangedHandler([this,"attr",t],()=>a(i));n&&this.attrHattrRemover.push(n)}),null===(n=e.$parent_deps)||void 0===n||n.forEach(e=>{var s;let n=null===(s=this.parent.properties[e])||void 0===s?void 0:s.addOnChangedHandler([this,"attr",t],()=>a(i));n&&this.attrHattrRemover.push(n)}),null===(r=e.$scope_deps)||void 0===r||r.forEach(e=>{var s;let[n,r]=this.get$ScopedPropsOwner(e),o=null===(s=r?n.properties[e]:n.meta[e])||void 0===s?void 0:s.addOnChangedHandler([this,"attr",t],()=>a(i));o&&this.attrHattrRemover.push(o)}),null===(h=e.$le_deps)||void 0===h||h.forEach(e=>{let s;f(()=>{s=this.$le[e[0]].properties[e[1]].addOnChangedHandler([this,"attr",t],()=>a(i))},l,l,l,"Cannot connect to CLE Obj by Id",5,(e,t)=>{e||a(i)}),this.attrHattrRemover.push((...e)=>s(...e))}),null===(p=e.$ctx_deps)||void 0===p||p.forEach(e=>{let s;f(()=>{s=this.$ctx[e[0]].properties[e[1]].addOnChangedHandler([this,"attr",t],()=>a(i))},l,l,l,"Cannot connect to CLE Obj by Ctx Id",5,(e,t)=>{e||a(i)}),this.attrHattrRemover.push((...e)=>s(...e))}),null===(u=e.$ref_deps)||void 0===u||u.forEach(e=>{let s;f(()=>{let n=this.getChildsRefOwner(e[0]).childsRefPointers[e[0]];if(Array.isArray(n))throw Error("Cannot Bind to multi-ref child");s=n.properties[e[1]].addOnChangedHandler([this,"attr",t],()=>a(i))},l,l,l,"Cannot connect to CLE Obj by Ref Name",5,(e,t)=>{e||a(i)}),this.attrHattrRemover.push(()=>s())})}a(i)}else if(m(i)){let e=()=>{let e=i.bind(void 0,this.$this)();null==e?this.html_pointer_element.hasAttribute(t)&&this.html_pointer_element.removeAttribute(t):"class"===t&&Array.isArray(e)?this.html_pointer_element.setAttribute(t,e.filter(e=>"string"==typeof e).join(" ").toString()):this.html_pointer_element.setAttribute(t,e.toString())},s=W(i);o.log("Attr static deps analysis: ",s),null===(_=s.$this_deps)||void 0===_||_.forEach(i=>{var s;let n=null===(s=this.properties[i])||void 0===s?void 0:s.addOnChangedHandler([this,"attr",t],()=>e());n&&this.attrHattrRemover.push(n)}),null===(v=s.$parent_deps)||void 0===v||v.forEach(i=>{var s;let n=null===(s=this.parent.properties[i])||void 0===s?void 0:s.addOnChangedHandler([this,"attr",t],()=>e());n&&this.attrHattrRemover.push(n)}),null===(g=s.$scope_deps)||void 0===g||g.forEach(i=>{var s;let[n,r]=this.get$ScopedPropsOwner(i),o=null===(s=r?n.properties[i]:n.meta[i])||void 0===s?void 0:s.addOnChangedHandler([this,"attr",t],()=>e());o&&this.attrHattrRemover.push(o)}),null===(C=s.$le_deps)||void 0===C||C.forEach(i=>{let s;f(()=>{s=this.$le[i[0]].properties[i[1]].addOnChangedHandler([this,"attr",t],()=>e())},l,l,l,"Cannot connect to CLE Obj by Id",5,(t,i)=>{t||e()}),this.attrHattrRemover.push((...e)=>s(...e))}),null===(y=s.$ctx_deps)||void 0===y||y.forEach(i=>{let s;f(()=>{s=this.$ctx[i[0]].properties[i[1]].addOnChangedHandler([this,"attr",t],()=>e())},l,l,l,"Cannot connect to CLE Obj by Ctx Id",5,(t,i)=>{t||e()}),this.attrHattrRemover.push((...e)=>s(...e))}),null===(b=s.$ref_deps)||void 0===b||b.forEach(i=>{let s;f(()=>{let n=this.getChildsRefOwner(i[0]).childsRefPointers[i[0]];if(Array.isArray(n))throw Error("Cannot Bind to multi-ref child");s=n.properties[i[1]].addOnChangedHandler([this,"attr",t],()=>e())},l,l,l,"Cannot connect to CLE Obj by Ref Name",5,(t,i)=>{t||e()}),this.attrHattrRemover.push(()=>s())}),e()}else if(i instanceof B){a.log("Found HAttrBinding attr: ",t,i,this);let s=i;i=i.bindFunc;let n=()=>{let e=i.bind(void 0,this.$this)();e!==this.html_pointer_element[t]&&(this.html_pointer_element[t]=null==e?void 0:e.toString())},r=W(i);if(a.log("Attr static deps analysis: ",r),null===(E=r.$this_deps)||void 0===E||E.forEach(i=>{var s;let r=null===(s=this.properties[i])||void 0===s?void 0:s.addOnChangedHandler([this,"attr",t],()=>n());r&&this.attrHattrRemover.push(r),e[t]=()=>this.properties[i]}),null===(O=r.$parent_deps)||void 0===O||O.forEach(i=>{var s;let r=null===(s=this.parent.properties[i])||void 0===s?void 0:s.addOnChangedHandler([this,"attr",t],()=>n());r&&this.attrHattrRemover.push(r),e[t]=()=>this.parent.properties[i]}),null===(x=r.$scope_deps)||void 0===x||x.forEach(i=>{var s,r;let[o,a]=this.get$ScopedPropsOwner(i);if(a){let r=null===(s=o.properties[i])||void 0===s?void 0:s.addOnChangedHandler([this,"attr",t],()=>n());r&&this.attrHattrRemover.push(r),e[t]=()=>o.properties[i]}else{let s=null===(r=o.meta[i])||void 0===r?void 0:r.addOnChangedHandler([this,"attr",t],()=>n());s&&this.attrHattrRemover.push(s),e[t]=()=>o.meta[i]}}),null===(R=r.$le_deps)||void 0===R||R.forEach(i=>{let s;f(()=>{s=this.$le[i[0]].properties[i[1]].addOnChangedHandler([this,"attr",t],()=>n())},l,l,l,"Cannot connect to CLE Obj by Id",5,(e,t)=>{e||n()}),this.attrHattrRemover.push((...e)=>s(...e)),e[t]=()=>this.$le[i[0]].properties[i[1]]}),null===(A=r.$ctx_deps)||void 0===A||A.forEach(i=>{let s;f(()=>{s=this.$ctx[i[0]].properties[i[1]].addOnChangedHandler([this,"attr",t],()=>n())},l,l,l,"Cannot connect to CLE Obj by Ctx Id",5,(e,t)=>{e||n()}),this.attrHattrRemover.push((...e)=>s(...e)),e[t]=()=>this.$ctx[i[0]].properties[i[1]]}),null===(w=r.$ref_deps)||void 0===w||w.forEach(i=>{let s;f(()=>{let e=this.getChildsRefOwner(i[0]).childsRefPointers[i[0]];if(Array.isArray(e))throw Error("Cannot Bind to multi-ref child");s=e.properties[i[1]].addOnChangedHandler([this,"attr",t],()=>n())},l,l,l,"Cannot connect to CLE Obj by Ref Name",5,(e,t)=>{e||n()}),this.attrHattrRemover.push(()=>s()),e[t]=()=>this.getChildsRefOwner(i[0]).childsRefPointers[i[0]].properties[i[1]]}),("input"===this.htmlElementType||"div"===this.htmlElementType)&&["value","checked"].includes(t)){if(!["button","hidden","image","reset","submit","file"].includes(this.convertedDefinition.attrs.type)){a.log("Found 2 way binding",t,this);let i=i=>{a.log("2way binding changes handled!");let n=e[t](),r=void 0!==s.remap?s.remap.bind(void 0,this.$this)(i.target[t],i):i.target[t];n.value!==r&&(n.value=r)};a.log("2way Chose event: ",null!==(H=s.event)&&void 0!==H?H:"input",t,this),this.html_pointer_element.addEventListener(null!==(P=s.event)&&void 0!==P?P:"input",i),this.signalsHandlerRemover.push(()=>this.html_pointer_element.removeEventListener(null!==(S=s.event)&&void 0!==S?S:"input",i))}}else if("textarea"===this.htmlElementType);else if("select"===this.htmlElementType&&"value"===t&&void 0===this.convertedDefinition.attrs.multiple){let i=i=>{let n=e[t](),r=void 0!==s.remap?s.remap.bind(void 0,this.$this)(i.target[t],i):i.target[t];n.value!==r&&(n.value=r)};this.html_pointer_element.addEventListener(null!==(j=s.event)&&void 0!==j?j:"change",i),this.signalsHandlerRemover.push(()=>this.html_pointer_element.removeEventListener(null!==(D=s.event)&&void 0!==D?D:"change",i))}else this.htmlElementType;n()}else null==i?this.html_pointer_element.hasAttribute(t)&&this.html_pointer_element.removeAttribute(t):"class"===t&&Array.isArray(i)?this.html_pointer_element.setAttribute(t,i.filter(e=>"string"==typeof e).join(" ").toString()):this.html_pointer_element.setAttribute(t,i.toString())}};t.startsWith("@lazy:")?(a.log("Found lazy attr!"),setTimeout(()=>s(t.replace("@lazy:","")),10)):s(t)})}if(void 0!==this.convertedDefinition.hattrs){o.log("Found hattrs: ",this.convertedDefinition.hattrs);let e={};Object.entries(this.convertedDefinition.hattrs).forEach(([t,i])=>{let s=t=>{var s,n,r,d,h,p,c,u,v,g,C,y,b,E,O,x,R,A,w,H,P,S,j,D,I,L,T,k,z,M,N,F;if(o.log("Exec HAttr: ",t,i),t.includes(".")){if(m(i)){let e=()=>{let[e,s]=_(this.html_pointer_element,t.split(".")),n=i.bind(void 0,this.$this)();e[s]=n},o=W(i);a.log("HAttr static deps analysis: ",o),null===(s=o.$this_deps)||void 0===s||s.forEach(i=>{var s;let n=null===(s=this.properties[i])||void 0===s?void 0:s.addOnChangedHandler([this,"attr",t],()=>e());n&&this.attrHattrRemover.push(n)}),null===(n=o.$parent_deps)||void 0===n||n.forEach(i=>{var s;let n=null===(s=this.parent.properties[i])||void 0===s?void 0:s.addOnChangedHandler([this,"attr",t],()=>e());n&&this.attrHattrRemover.push(n)}),null===(r=o.$scope_deps)||void 0===r||r.forEach(i=>{var s;let[n,r]=this.get$ScopedPropsOwner(i),o=null===(s=r?n.properties[i]:n.meta[i])||void 0===s?void 0:s.addOnChangedHandler([this,"attr",t],()=>e());o&&this.attrHattrRemover.push(o)}),null===(d=o.$le_deps)||void 0===d||d.forEach(i=>{let s;f(()=>{s=this.$le[i[0]].properties[i[1]].addOnChangedHandler([this,"attr",t],()=>e())},l,l,l,"Cannot connect to CLE Obj by Id",5,(t,i)=>{t||e()}),this.attrHattrRemover.push((...e)=>s(...e))}),null===(h=o.$ctx_deps)||void 0===h||h.forEach(i=>{let s;f(()=>{s=this.$ctx[i[0]].properties[i[1]].addOnChangedHandler([this,"attr",t],()=>e())},l,l,l,"Cannot connect to CLE Obj by Ctx Id",5,(t,i)=>{t||e()}),this.attrHattrRemover.push((...e)=>s(...e))}),null===(p=o.$ref_deps)||void 0===p||p.forEach(i=>{let s;f(()=>{let n=this.getChildsRefOwner(i[0]).childsRefPointers[i[0]];if(Array.isArray(n))throw Error("Cannot Bind to multi-ref child");s=n.properties[i[1]].addOnChangedHandler([this,"attr",t],()=>e())},l,l,l,"Cannot connect to CLE Obj by Ref Name",5,(t,i)=>{t||e()}),this.attrHattrRemover.push(()=>s())}),e(),"style"===t.split(".")[0]&&(null===(c=this.singlePropStyleRecomputeHooks)||void 0===c||c.push(()=>e()))}else if(i instanceof B){a.log("Found binding hattr: ",t,i,this);let s=i;i=i.bindFunc;let n=()=>{let[e,s]=_(this.html_pointer_element,t.split(".")),n=i.bind(void 0,this.$this)();n!==this.html_pointer_element[t]&&(e[s]=n)},r=W(i);a.log("HAttr static deps analysis: ",r),null===(u=r.$this_deps)||void 0===u||u.forEach(i=>{var s;let r=null===(s=this.properties[i])||void 0===s?void 0:s.addOnChangedHandler([this,"attr",t],()=>n());r&&this.attrHattrRemover.push(r),e[t]=()=>this.properties[i]}),null===(v=r.$parent_deps)||void 0===v||v.forEach(i=>{var s;let r=null===(s=this.parent.properties[i])||void 0===s?void 0:s.addOnChangedHandler([this,"attr",t],()=>n());r&&this.attrHattrRemover.push(r),e[t]=()=>this.parent.properties[i]}),null===(g=r.$scope_deps)||void 0===g||g.forEach(i=>{var s,r;let[o,a]=this.get$ScopedPropsOwner(i);if(a){let r=null===(s=o.properties[i])||void 0===s?void 0:s.addOnChangedHandler([this,"attr",t],()=>n());r&&this.attrHattrRemover.push(r),e[t]=()=>o.properties[i]}else{let s=null===(r=o.meta[i])||void 0===r?void 0:r.addOnChangedHandler([this,"attr",t],()=>n());s&&this.attrHattrRemover.push(s),e[t]=()=>o.meta[i]}}),null===(C=r.$le_deps)||void 0===C||C.forEach(i=>{let s;f(()=>{s=this.$le[i[0]].properties[i[1]].addOnChangedHandler([this,"attr",t],()=>n())},l,l,l,"Cannot connect to CLE Obj by Id",5,(e,t)=>{e||n()}),this.attrHattrRemover.push((...e)=>s(...e)),e[t]=()=>this.$le[i[0]].properties[i[1]]}),null===(y=r.$ctx_deps)||void 0===y||y.forEach(i=>{let s;f(()=>{s=this.$ctx[i[0]].properties[i[1]].addOnChangedHandler([this,"attr",t],()=>n())},l,l,l,"Cannot connect to CLE Obj by Ctx Id",5,(e,t)=>{e||n()}),this.attrHattrRemover.push((...e)=>s(...e)),e[t]=()=>this.$ctx[i[0]].properties[i[1]]}),null===(b=r.$ref_deps)||void 0===b||b.forEach(i=>{let s;f(()=>{let e=this.getChildsRefOwner(i[0]).childsRefPointers[i[0]];if(Array.isArray(e))throw Error("Cannot Bind to multi-ref child");s=e.properties[i[1]].addOnChangedHandler([this,"attr",t],()=>n())},l,l,l,"Cannot connect to CLE Obj by Ref Name",5,(e,t)=>{e||n()}),this.attrHattrRemover.push(()=>s()),e[t]=()=>this.getChildsRefOwner(i[0]).childsRefPointers[i[0]].properties[i[1]]}),a.log("Exec 2 way bidning",t,this);let o=i=>{a.log("2way binding changes handled!");let n=e[t](),[r,o]=_(i.target,t.split(".")),d=void 0!==s.remap?s.remap.bind(void 0,this.$this)(r[o],i):r[o];n.value!==d&&(n.value=d)};a.log("Chosing event: ",null!==(E=s.event)&&void 0!==E?E:"input",t,this),this.html_pointer_element.addEventListener(null!==(O=s.event)&&void 0!==O?O:"input",o),this.signalsHandlerRemover.push(()=>this.html_pointer_element.removeEventListener(null!==(x=s.event)&&void 0!==x?x:"input",o)),n()}else{let e=()=>{let[e,s]=_(this.html_pointer_element,t.split("."));e[s]=i};e(),"style"===t.split(".")[0]&&(null===(R=this.singlePropStyleRecomputeHooks)||void 0===R||R.push(()=>e()))}}else if(m(i)){let e=()=>{this.html_pointer_element[t]=i.bind(void 0,this.$this)()},s=W(i);a.log("HAttr static deps analysis: ",s),null===(A=s.$this_deps)||void 0===A||A.forEach(i=>{var s;let n=null===(s=this.properties[i])||void 0===s?void 0:s.addOnChangedHandler([this,"attr",t],()=>e());n&&this.attrHattrRemover.push(n)}),null===(w=s.$parent_deps)||void 0===w||w.forEach(i=>{var s;let n=null===(s=this.parent.properties[i])||void 0===s?void 0:s.addOnChangedHandler([this,"attr",t],()=>e());n&&this.attrHattrRemover.push(n)}),null===(H=s.$scope_deps)||void 0===H||H.forEach(i=>{var s;let[n,r]=this.get$ScopedPropsOwner(i),o=null===(s=r?n.properties[i]:n.meta[i])||void 0===s?void 0:s.addOnChangedHandler([this,"attr",t],()=>e());o&&this.attrHattrRemover.push(o)}),null===(P=s.$le_deps)||void 0===P||P.forEach(i=>{let s;f(()=>{s=this.$le[i[0]].properties[i[1]].addOnChangedHandler([this,"attr",t],()=>e())},l,l,l,"Cannot connect to CLE Obj by Id",5,(t,i)=>{t||e()}),this.attrHattrRemover.push((...e)=>s(...e))}),null===(S=s.$ctx_deps)||void 0===S||S.forEach(i=>{let s;f(()=>{s=this.$ctx[i[0]].properties[i[1]].addOnChangedHandler([this,"attr",t],()=>e())},l,l,l,"Cannot connect to CLE Obj by Ctx Id",5,(t,i)=>{t||e()}),this.attrHattrRemover.push((...e)=>s(...e))}),null===(j=s.$ref_deps)||void 0===j||j.forEach(i=>{let s;f(()=>{let n=this.getChildsRefOwner(i[0]).childsRefPointers[i[0]];if(Array.isArray(n))throw Error("Cannot Bind to multi-ref child");s=n.properties[i[1]].addOnChangedHandler([this,"attr",t],()=>e())},l,l,l,"Cannot connect to CLE Obj by Ref Name",5,(t,i)=>{t||e()}),this.attrHattrRemover.push(()=>s())}),e()}else if(i instanceof B){a.log("Found binding hattr: ",t,i,this);let s=i;i=i.bindFunc;let n=()=>{let e=i.bind(void 0,this.$this)();e!==this.html_pointer_element[t]&&(this.html_pointer_element[t]=e)},r=W(i);a.log("hattr static deps analysis: ",r),null===(D=r.$this_deps)||void 0===D||D.forEach(i=>{var s;let r=null===(s=this.properties[i])||void 0===s?void 0:s.addOnChangedHandler([this,"attr",t],()=>n());r&&this.attrHattrRemover.push(r),e[t]=()=>this.properties[i]}),null===(I=r.$parent_deps)||void 0===I||I.forEach(i=>{var s;let r=null===(s=this.parent.properties[i])||void 0===s?void 0:s.addOnChangedHandler([this,"attr",t],()=>n());r&&this.attrHattrRemover.push(r),e[t]=()=>this.parent.properties[i]}),null===(L=r.$scope_deps)||void 0===L||L.forEach(i=>{var s,r;let[o,a]=this.get$ScopedPropsOwner(i);if(a){let r=null===(s=o.properties[i])||void 0===s?void 0:s.addOnChangedHandler([this,"attr",t],()=>n());r&&this.attrHattrRemover.push(r),e[t]=()=>o.properties[i]}else{let s=null===(r=o.meta[i])||void 0===r?void 0:r.addOnChangedHandler([this,"attr",t],()=>n());s&&this.attrHattrRemover.push(s),e[t]=()=>o.meta[i]}}),null===(T=r.$le_deps)||void 0===T||T.forEach(i=>{let s;f(()=>{s=this.$le[i[0]].properties[i[1]].addOnChangedHandler([this,"attr",t],()=>n())},l,l,l,"Cannot connect to CLE Obj by Id",5,(e,t)=>{e||n()}),this.attrHattrRemover.push((...e)=>s(...e)),e[t]=()=>this.$le[i[0]].properties[i[1]]}),null===(k=r.$ctx_deps)||void 0===k||k.forEach(i=>{let s;f(()=>{s=this.$ctx[i[0]].properties[i[1]].addOnChangedHandler([this,"attr",t],()=>n())},l,l,l,"Cannot connect to CLE Obj by Ctx Id",5,(e,t)=>{e||n()}),this.attrHattrRemover.push((...e)=>s(...e)),e[t]=()=>this.$ctx[i[0]].properties[i[1]]}),null===(z=r.$ref_deps)||void 0===z||z.forEach(i=>{let s;f(()=>{let e=this.getChildsRefOwner(i[0]).childsRefPointers[i[0]];if(Array.isArray(e))throw Error("Cannot Bind to multi-ref child");s=e.properties[i[1]].addOnChangedHandler([this,"attr",t],()=>n())},l,l,l,"Cannot connect to CLE Obj by Ref Name",5,(e,t)=>{e||n()}),this.attrHattrRemover.push(()=>s()),e[t]=()=>this.getChildsRefOwner(i[0]).childsRefPointers[i[0]].properties[i[1]]}),a.log("Exec 2 way bidning",t,this);let o=i=>{a.log("2way binding changes handled!");let n=e[t](),r=void 0!==s.remap?s.remap.bind(void 0,this.$this)(i.target[t],i):i.target[t];n.value!==r&&(n.value=r)};a.log("Chosing event: ",null!==(M=s.event)&&void 0!==M?M:"input",t,this),this.html_pointer_element.addEventListener(null!==(N=s.event)&&void 0!==N?N:"input",o),this.signalsHandlerRemover.push(()=>this.html_pointer_element.removeEventListener(null!==(F=s.event)&&void 0!==F?F:"input",o)),n()}else this.html_pointer_element[t]=i};t.startsWith("@lazy:")?(a.log("Found lazy!"),setTimeout(()=>s(t.replace("@lazy:","")),10)):s(t)})}if(void 0!==this.convertedDefinition.css){void 0===this.css_html_pointer_element&&(this.css_html_pointer_element=document.createElement("style"),document.getElementsByTagName("head")[0].appendChild(this.css_html_pointer_element));let e=[],t=()=>{this.css_html_pointer_element.innerText=e.map(e=>e.value.replaceAll("\n","").replaceAll("	"," ").replaceAll("   ","").replaceAll("  "," ")).join(" ")};(Array.isArray(this.convertedDefinition.css)?this.convertedDefinition.css:Object.values(this.convertedDefinition.css)).forEach(i=>{e.push(new x(i,h,t,h,()=>this.$this,(e,i)=>{var s,n,r,o,a,d;let h=[];return null===(s=i.$this_deps)||void 0===s||s.forEach(t=>{var i;let s=null===(i=this.properties[t])||void 0===i?void 0:i.addOnChangedHandler(e,()=>e.markAsChanged());s&&h.push(s)}),null===(n=i.$parent_deps)||void 0===n||n.forEach(t=>{var i;let s=null===(i=this.parent.properties[t])||void 0===i?void 0:i.addOnChangedHandler(e,()=>e.markAsChanged());s&&h.push(s)}),null===(r=i.$scope_deps)||void 0===r||r.forEach(t=>{var i;let[s,n]=this.get$ScopedPropsOwner(t),r=null===(i=n?s.properties[t]:s.meta[t])||void 0===i?void 0:i.addOnChangedHandler(e,()=>e.markAsChanged());r&&h.push(r)}),null===(o=i.$le_deps)||void 0===o||o.forEach(i=>{let s;f(()=>{s=this.$le[i[0]].properties[i[1]].addOnChangedHandler(e,()=>e.markAsChanged())},l,l,l,"Cannot connect to CLE Obj by Id",5,(e,i)=>{e||t()}),h.push((...e)=>s(...e))}),null===(a=i.$ctx_deps)||void 0===a||a.forEach(i=>{let s;f(()=>{s=this.$ctx[i[0]].properties[i[1]].addOnChangedHandler(e,()=>e.markAsChanged())},l,l,l,"Cannot connect to CLE Obj by Ctx Id",5,(e,i)=>{e||t()}),h.push((...e)=>s(...e))}),null===(d=i.$ref_deps)||void 0===d||d.forEach(i=>{let s;f(()=>{let t=this.getChildsRefOwner(i[0]).childsRefPointers[i[0]];if(Array.isArray(t))throw Error("Cannot Bind to multi-ref child");s=t.properties[i[1]].addOnChangedHandler(e,()=>e.markAsChanged())},l,l,l,"Cannot connect to CLE Obj by Ref Name",5,(e,i)=>{e||t()}),h.push(()=>s())}),h},!0))}),t()}if(this.isA$ctxComponent&&void 0!==this.convertedDefinition.constructor){let e={};void 0!==this.oj_definition.init&&Object.entries(this.oj_definition.init).forEach(([t,i])=>{i instanceof S?e[t]=i.build(this.parent.$this):e[t]=m(i)?i.bind(void 0,this.parent.$this):i}),this.hooks.constructor=this.convertedDefinition.constructor.bind(void 0,this.$this,e)}if(void 0!==this.convertedDefinition.onInit&&(this.hooks.onInit=this.convertedDefinition.onInit.bind(void 0,this.$this)),void 0!==this.convertedDefinition.afterChildsInit&&(this.hooks.afterChildsInit=this.convertedDefinition.afterChildsInit.bind(void 0,this.$this)),void 0!==this.convertedDefinition.afterInit&&(this.hooks.afterInit=this.convertedDefinition.afterInit.bind(void 0,this.$this)),void 0!==this.convertedDefinition.onUpdate&&(this.hooks.onUpdate=this.convertedDefinition.onUpdate.bind(void 0,this.$this)),void 0!==this.convertedDefinition.onDestroy&&(this.hooks.onDestroy=this.convertedDefinition.onDestroy.bind(void 0,this.$this)),this.isA$ctxComponent&&void 0!==this.convertedDefinition.constructor&&this.hooks.constructor(),void 0!==this.hooks.onInit){let e=this.hooks.onInit();this.hooks_destructors.onInit="function"==typeof e?e:void 0}for(let t of((null===(e=this.directives)||void 0===e?void 0:e.onInit)!==void 0&&this.directives.onInit.map(e=>e.bind(void 0,this.$this)()).filter(e=>void 0!==e&&"function"==typeof e).forEach(e=>this.directives_hooks_destructors.push(e)),this.childs))t.create();if(void 0!==this.hooks.afterChildsInit&&this.hooks.afterChildsInit(),(null===(t=this.directives)||void 0===t?void 0:t.afterChildsInit)!==void 0&&this.directives.afterChildsInit.map(e=>e.bind(void 0,this.$this)()).filter(e=>void 0!==e&&"function"==typeof e).forEach(e=>this.directives_hooks_destructors.push(e)),void 0!==this.hooks.afterInit&&setTimeout(()=>this.hooks.afterInit(),1),(null===(i=this.directives)||void 0===i?void 0:i.afterInit)!==void 0&&this.directives.afterInit.map(e=>setTimeout(()=>e.bind(void 0,this.$this)(),1)).filter(e=>void 0!==e&&"function"==typeof e).forEach(e=>this.directives_hooks_destructors.push(e)),void 0!==this.convertedDefinition.s_css){void 0===this.s_css_html_pointer_element&&(this.s_css_html_pointer_element=document.createElement("style"),document.getElementsByTagName("head")[0].appendChild(this.s_css_html_pointer_element));let e=[],t=()=>{this.s_css_html_pointer_element.innerText=e.map(([e,t])=>`[${this.t_uid}]${e},[${this.t_uid}] ${e}{${c(t.value)}}`).join(" ")};Object.entries(this.convertedDefinition.s_css).forEach(([i,s])=>{s.forEach(s=>{e.push([i,new x(s,h,t,h,()=>this.$this,(e,i)=>{var s,n,r,o,a,d;let h=[];return null===(s=i.$this_deps)||void 0===s||s.forEach(t=>{var i;let s=null===(i=this.properties[t])||void 0===i?void 0:i.addOnChangedHandler(e,()=>e.markAsChanged());s&&h.push(s)}),null===(n=i.$parent_deps)||void 0===n||n.forEach(t=>{var i;let s=null===(i=this.parent.properties[t])||void 0===i?void 0:i.addOnChangedHandler(e,()=>e.markAsChanged());s&&h.push(s)}),null===(r=i.$scope_deps)||void 0===r||r.forEach(t=>{var i;let[s,n]=this.get$ScopedPropsOwner(t),r=null===(i=n?s.properties[t]:s.meta[t])||void 0===i?void 0:i.addOnChangedHandler(e,()=>e.markAsChanged());r&&h.push(r)}),null===(o=i.$le_deps)||void 0===o||o.forEach(i=>{let s;f(()=>{s=this.$le[i[0]].properties[i[1]].addOnChangedHandler(e,()=>e.markAsChanged())},l,l,l,"Cannot connect to CLE Obj by Id",5,(e,i)=>{e||t()}),h.push((...e)=>s(...e))}),null===(a=i.$ctx_deps)||void 0===a||a.forEach(i=>{let s;f(()=>{s=this.$ctx[i[0]].properties[i[1]].addOnChangedHandler(e,()=>e.markAsChanged())},l,l,l,"Cannot connect to CLE Obj by Ctx Id",5,(e,i)=>{e||t()}),h.push((...e)=>s(...e))}),null===(d=i.$ref_deps)||void 0===d||d.forEach(i=>{let s;f(()=>{let t=this.getChildsRefOwner(i[0]).childsRefPointers[i[0]];if(Array.isArray(t))throw Error("Cannot Bind to multi-ref child");s=t.properties[i[1]].addOnChangedHandler(e,()=>e.markAsChanged())},l,l,l,"Cannot connect to CLE Obj by Ref Name",5,(e,i)=>{e||t()}),h.push(()=>s())}),h},!0)])})}),t()}}destroy(){var e,t,i,s,n,r,o,a,d,l;void 0!==this.directives.onDestroy&&this.directives.onDestroy.forEach(e=>e.bind(void 0,this.$this)()),void 0!==this.directives_hooks_destructors&&this.directives_hooks_destructors.length&&(this.directives_hooks_destructors.forEach(e=>e.bind(void 0,this.$this)()),this.directives_hooks_destructors=void 0),(null===(e=this.hooks_destructors)||void 0===e?void 0:e.onInit)!==void 0&&(null===(d=this.hooks_destructors.onInit)||void 0===d||null===(l=d.bind)||void 0===l||l.call(d,void 0,this.$this)(),this.hooks_destructors.onInit=void 0),void 0!==this.hooks.onDestroy&&this.hooks.onDestroy(),null===(t=this.childs)||void 0===t||t.forEach(e=>e.destroy()),this.destroyDynamicChilds(void 0,!0,!0),null===(i=this.html_pointer_element)||void 0===i||i.remove(),null===(s=this.css_html_pointer_element)||void 0===s||s.remove(),this.css_html_pointer_element=void 0,null===(n=this.s_css_html_pointer_element)||void 0===n||n.remove(),this.s_css_html_pointer_element=void 0;try{delete this.$ctx[this.id]}catch{}try{delete this.$ctx[this.ctx_id]}catch{}try{this.isMyParentHtmlRoot&&delete this.$le.root}catch{}try{this.isA$ctxComponent&&delete this.$ctx.root}catch{}try{this.isA$ctxComponent&&!this.isMyParentHtmlRoot&&void 0!==this.ctx_ref_id&&delete this.parent.$ctx[this.ctx_ref_id]}catch{}delete this.$le[this.id],this.unregisterAsChildsRef(),null===(r=this.handlerRemover)||void 0===r||r.forEach(e=>{try{e()}catch{}}),null===(o=this.attrHattrRemover)||void 0===o||o.forEach(e=>{try{e()}catch{}}),this.singlePropStyleRecomputeHooks=void 0,Object.values(this.signals).forEach(e=>{try{e.destroy()}catch{}}),null===(a=this.signalsHandlerRemover)||void 0===a||a.forEach(e=>{try{e()}catch{}}),Object.values(this.properties).forEach(e=>{try{e.destroy(!0)}catch{}}),this.$oos=void 0}destroyDynamicChilds(e,t=!1,i=!1){var s,n,r;this.dynamicChildsBeforeDestroy(this.parent.$this,this.dynamicChildsState),void 0===e?(null===(s=this.dynamicChilds)||void 0===s||s.forEach(e=>e.destroy()),this.dynamicChilds=[]):(null===(n=this.dynamicChilds)||void 0===n||n.forEach(t=>e.includes(t.$this)&&t.destroy()),this.dynamicChilds=null===(r=this.dynamicChilds)||void 0===r?void 0:r.filter(t=>!e.includes(t.$this))),this.dynamicChildsAfterDestroy(this.parent.$this,this.dynamicChildsState),t&&(this.dynamicChildsState={}),i&&(this.dynamicChildsBeforeDestroy=(e,t)=>{},this.dynamicChildsBeforeDestroy=(e,t)=>{})}constructor(e,t,i,n){var o,a,d,l,h,p;(0,s._)(this,"t_uid",void 0),(0,s._)(this,"id",void 0),(0,s._)(this,"ctx_id",void 0),(0,s._)(this,"ctx_ref_id",void 0),(0,s._)(this,"oj_definition",void 0),(0,s._)(this,"convertedDefinition",void 0),(0,s._)(this,"isMyParentHtmlRoot",void 0),(0,s._)(this,"parent",void 0),(0,s._)(this,"childs",void 0),(0,s._)(this,"dynamicChilds",[]),(0,s._)(this,"dynamicChildsBeforeDestroy",(e,t)=>{}),(0,s._)(this,"dynamicChildsAfterDestroy",(e,t)=>{}),(0,s._)(this,"dynamicChildsState",{}),(0,s._)(this,"properties",{}),(0,s._)(this,"signals",{}),(0,s._)(this,"hooks",{}),(0,s._)(this,"hooks_destructors",{}),(0,s._)(this,"meta",{}),(0,s._)(this,"directives",{}),(0,s._)(this,"directives_hooks_destructors",void 0),(0,s._)(this,"signalsHandlerRemover",[]),(0,s._)(this,"attrHattrRemover",[]),(0,s._)(this,"handlerRemover",[]),(0,s._)(this,"defDeps",{}),(0,s._)(this,"$this",void 0),(0,s._)(this,"$parent",void 0),(0,s._)(this,"$scope",void 0),(0,s._)(this,"$le",void 0),(0,s._)(this,"$ctx",void 0),(0,s._)(this,"isA$ctxComponent",!1),(0,s._)(this,"$dbus",void 0),(0,s._)(this,"$meta",void 0),(0,s._)(this,"$ref",void 0),(0,s._)(this,"childsRefPointers",{}),(0,s._)(this,"$oos",void 0),(0,s._)(this,"htmlElementType",void 0),(0,s._)(this,"isObjComponent",void 0),(0,s._)(this,"html_pointer_element",void 0),(0,s._)(this,"html_end_pointer_element",void 0),(0,s._)(this,"css_html_pointer_element",void 0),(0,s._)(this,"s_css_html_pointer_element",void 0),(0,s._)(this,"singlePropStyleRecomputeHooks",[]),this.t_uid=Y.generate(),this.isA$ctxComponent=t instanceof H||!(e instanceof Q),this.parent=e,this.isMyParentHtmlRoot=e instanceof HTMLElement,this.oj_definition=t,this.htmlElementType=k(t),this.isObjComponent=["Model","Controller","Service","service","Component","Connector","Signals","Style","Css"].includes(this.htmlElementType),this.isPlaceholderPointerComponent=["LazyPointer"].includes(this.htmlElementType),this.convertedDefinition=Q.parseComponentDefinition((t instanceof H?t.computedTemplate:t)[this.htmlElementType]),this.meta_options={isNewScope:null===(o=this.convertedDefinition.meta)||void 0===o?void 0:o.newScope,noThisInScope:null===(a=this.convertedDefinition.meta)||void 0===a?void 0:a.noThisInScope,noMetaInScope:null===(d=this.convertedDefinition.meta)||void 0===d?void 0:d.noMetaInScope,hasViewChilds:null===(l=this.convertedDefinition.meta)||void 0===l?void 0:l.hasViewChilds,metaPushbackAutomark:null!==(p=null===(h=this.convertedDefinition.meta)||void 0===h?void 0:h.metaPushbackAutomark)&&void 0!==p?p:r.DEFAULTS.META.PUSHBACK_AUTOMARK},this.$le=i,this.$dbus=n,this.$ctx=this.getMy$ctx(),this.$meta=this.getMy$meta(),this.defineAndRegisterId()}}(0,s._)(Q,"parseComponentDefinition",e=>{let t={},i=[],s=(...e)=>{i=[...i,...e]},{childs:n,contains:r,text:o,view:d,">>":l,"=>":h,_:c,"":u}=e;t.childs=n||r||o||d||l||h||c||u,void 0===t.childs||Array.isArray(t.childs)||(t.childs=[t.childs]),s("childs","contains","text","view",">>","=>","_",""),t.state=e.state||"initial",s("state"),p(e,t,["constructor","beforeInit","onInit","afterInit","afterChildsInit","onUpdate","onDestroy","signals","dbus_signals","on","on_s","on_a","alias","handle","when","css","s_css","states","stateChangeStrategy","onState","name","childsRef","oos"]),s("constructor","beforeInit","onInit","afterInit","afterChildsInit","onUpdate","onDestroy","signals","dbus_signals","on","on_s","on_a","alias","handle","when","css","s_css","states","stateChangeStrategy","onState","name","childsRef","oos"),t.checked_deps=e.deps,s("deps");let{id:m,ctx_id:_,ctx_ref_id:f,def:v,"private:def":g,attrs:C,"private:attrs":y,a:b,"private:a":E,hattrs:O,"private:hattrs":x,ha:R,"private:ha":A}=e;s("id","ctx_id","ctx_ref_id","def","private:def","attrs","private:attrs","a","private:a","hattrs","private:hattrs","ha","private:ha"),t.id=m||Z.generate(),t.ctx_id=_||t.id,t.ctx_ref_id=f,void 0!==v&&(t.def=v),void 0!==g&&(t._def=g),(void 0!==C||void 0!==b)&&(t.attrs=C||b),(void 0!==y||void 0!==E)&&(t._attrs=y||E),(void 0!==O||void 0!==R)&&(t.hattrs=O||R),(void 0!==x||void 0!==A)&&(t._hattrs=x||A);let w=Object.keys(e).filter(e=>e.startsWith("a.")||e.startsWith("attrs."));if(s(...w),w.length>0){let i={};w.forEach(t=>{i[t.split(".")[1]]=e[t]}),void 0!==t.attrs?t.attrs={...t.attrs,...i}:t.attrs=i}let H=Object.keys(e).filter(e=>e.startsWith("ha.")||e.startsWith("hattrs."));if(s(...H),H.length>0){let i={};H.forEach(t=>{let s=t.split(".");s.shift(),i[s=s.join(".")]=e[t]}),void 0!==t.hattrs?t.hattrs={...t.hattrs,...i}:t.hattrs=i}let{meta:P}=e;s("meta"),t.meta=P;let{data:S,"private:data":j,props:D,"private:props":I,let:L,"private:let":T}=e;s("data","private:data","props","private:props","let","private:let"),t.data=S||D||L||{},t._data=j||I||T||{};let{directives:k}=e;s("directives"),t.directives=k;let W={attrs:{},hattrs:{},data:{},def:{},handle:{},when_event_listener:{},signals:{},dbus_signals:{},on_this:{},on_parent:{},on_scope:{},on_dbus:{},on_le:{},on_ctx:{},on_ref:{},directives:{}};if(Object.keys(e).forEach(t=>{if(t.includes("_")){let i=e[t];if(t.startsWith("a_"))W.attrs[t.substring(2)]=i,s(t);else if(t.startsWith("attr_"))W.attrs[t.substring(5)]=i,s(t);else if(t.startsWith("ha_"))W.hattrs[t.substring(3)]=i,s(t);else if(t.startsWith("hattr_"))W.hattrs[t.substring(6)]=i,s(t);else if(t.startsWith("p_"))W.data[t.substring(2)]=i,s(t);else if(t.startsWith("let_"))W.data[t.substring(4)]=i,s(t);else if(t.startsWith("let "))W.data[t.substring(4)]=i,s(t);else if(t.startsWith("d_"))W.def[t.substring(2)]=i,s(t);else if(t.startsWith("def_"))W.def[t.substring(4)]=i,s(t);else if(t.startsWith("h_"))W.handle[t.substring(2)]=i,s(t);else if(t.startsWith("ev_"))W.handle[t.substring(3)]=i,s(t);else if(t.startsWith("handle_"))W.handle[t.substring(7)]=i,s(t);else if(t.startsWith("w_"))W.when_event_listener[t.substring(2)]=i,s(t);else if(t.startsWith("when_"))W.when_event_listener[t.substring(5)]=i,s(t);else if(t.startsWith("s_"))W.signals[t.substring(2)]=i,s(t);else if(t.startsWith("signal_"))W.signals[t.substring(7)]=i,s(t);else if(t.startsWith("dbus_signal_"))W.dbus_signals[t.substring(12)]=i,s(t);else if(t.startsWith("on_")){if(t.startsWith("on_this_"))W.on_this[t.substring(8)]=i,s(t);else if(t.startsWith("on_parent_"))W.on_parent[t.substring(10)]=i,s(t);else if(t.startsWith("on_scope_"))W.on_scope[t.substring(9)]=i,s(t);else if(t.startsWith("on_dbus_"))W.on_dbus[t.substring(8)]=i,s(t);else if(t.startsWith("on_le_")){let[e,...n]=t.substring(6).split("_"),r=n.join("_");void 0!==W.on_le[e]?W.on_le[e][r]=i:W.on_le[e]={[r]:i},s(t)}else if(t.startsWith("on_ctx_")){let[e,...n]=t.substring(7).split("_"),r=n.join("_");void 0!==W.on_ctx[e]?W.on_ctx[e][r]=i:W.on_ctx[e]={[r]:i},s(t)}else if(t.startsWith("on_ctx_")){let[e,...n]=t.substring(7).split("_"),r=n.join("_");void 0!==W.on_ref[e]?W.on_ref[e][r]=i:W.on_ref[e]={[r]:i},s(t)}else t.startsWith("on_s_")?W.on_scope[t.substring(5)]=i:W.on_scope[t.substring(3)]=i,s(t)}else t.startsWith("on")&&t.endsWith("_event")?(W.handle[t.substring(0,t.length-6)]=i,s(t)):t.startsWith("dir_")&&(W.directives[t.substring(4)]=i,s(t))}else["class","style"].includes(t)?(W.attrs[t]=e[t],s(t)):["onclick"].includes(t)&&(W.handle[t]=e[t],s(t))}),Object.keys(e).forEach(t=>{i.includes(t)||(W.data[t]=e[t],a.log("CLE-INFO: unrecognized ",t," converted into props!"))}),Object.keys(W.attrs).length>0&&(void 0!==t.attrs?t.attrs={...t.attrs,...W.attrs}:t.attrs=W.attrs),Object.keys(W.hattrs).length>0&&(void 0!==t.hattrs?t.hattrs={...t.hattrs,...W.hattrs}:t.hattrs=W.hattrs),Object.keys(W.data).length>0&&(void 0!==t.data?t.data={...t.data,...W.data}:t.data=W.data),Object.keys(W.def).length>0&&(void 0!==t.def?t.def={...t.def,...W.def}:t.def=W.def),Object.keys(W.handle).length>0&&(void 0!==t.handle?t.handle={...t.handle,...W.handle}:t.handle=W.handle),Object.keys(W.when_event_listener).length>0&&(void 0!==t.when_event_listener?t.when_event_listener={...t.when_event_listener,...W.when_event_listener}:t.when_event_listener=W.when_event_listener),Object.keys(W.signals).length>0&&(void 0!==t.signals?t.signals={...t.signals,...W.signals}:t.signals=W.signals),Object.keys(W.dbus_signals).length>0&&(void 0!==t.dbus_signals?t.dbus_signals={...t.dbus_signals,...W.dbus_signals}:t.dbus_signals=W.dbus_signals),Object.keys(W.on_this).length>0&&(void 0!==t.on?void 0!==t.on.this?t.on.this={...t.on.this,...W.on_this}:t.on.this=W.on_this:t.on={this:W.on_this}),Object.keys(W.on_parent).length>0&&(void 0!==t.on?void 0!==t.on.parent?t.on.parent={...t.on.parent,...W.on_parent}:t.on.parent=W.on_parent:t.on={parent:W.on_parent}),Object.keys(W.on_scope).length>0&&(void 0!==t.on?void 0!==t.on.scope?t.on.scope={...t.on.scope,...W.on_scope}:t.on.scope=W.on_scope:t.on={scope:W.on_scope}),Object.keys(W.on_dbus).length>0&&(void 0!==t.on?void 0!==t.on.dbus?t.on.dbus={...t.on.dbus,...W.on_dbus}:t.on.dbus=W.on_dbus:t.on={dbus:W.on_dbus}),Object.keys(W.on_le).length>0){if(void 0!==t.on){if(void 0!==t.on.le){let e={...t.on.le};Object.entries(W.on_le).forEach(([t,i])=>{void 0!==e[t]?e[t]={...e[t],...i}:e[t]={...i}}),t.on.le=e}else t.on.le=W.on_le}else t.on={le:W.on_le}}if(Object.keys(W.on_ctx).length>0){if(void 0!==t.on){if(void 0!==t.on.ctx){let e={...t.on.ctx};Object.entries(W.on_ctx).forEach(([t,i])=>{void 0!==e[t]?e[t]={...e[t],...i}:e[t]={...i}}),t.on.ctx=e}else t.on.ctx=W.on_ctx}else t.on={ctx:W.on_ctx}}if(Object.keys(W.on_ref).length>0){if(void 0!==t.on){if(void 0!==t.on.ref){let e={...t.on.ref};Object.entries(W.on_ref).forEach(([t,i])=>{void 0!==e[t]?e[t]={...e[t],...i}:e[t]={...i}}),t.on.ref=e}else t.on.ref=W.on_ref}else t.on={ref:W.on_ref}}if(Object.keys(W.directives).length>0&&(void 0!==t.directives?t.directives={...t.directives,...W.directives}:t.directives=W.directives),void 0!==t.beforeInit){let e=t.beforeInit(t,t.childs);t=void 0!==e?e:t}return t}),(0,s._)(Q,"componentFactory",(e,t,i,s)=>{if("string"==typeof t||"function"==typeof t||O(t))return new X(e,t);a.log("Component Factory: ",e,t);let n=k(t),r=(t instanceof H?t.computedTemplate:t)[n];if(eH.has(n)){let t=eH.get(n);return Q.componentFactory(e,Array.isArray(r)?t(...r):t(r),i,s)}return("string"==typeof r||"function"==typeof r||Array.isArray(r))&&(r={text:r},t={[n]:r}),"meta"in r?"if"in r.meta?new et(e,t,i,s):"forEach"in r.meta?new es(e,t,i,s):new Q(e,t,i,s):new Q(e,t,i,s)});class X{buildSkeleton(){this.buildHtmlPointerElement()}buildHtmlPointerElement(){this.html_pointer_element=document.createTextNode(""),this.parent.html_pointer_element.appendChild(this.html_pointer_element)}_renderizeText(){this.html_pointer_element.textContent=m(this.definition)||O(this.definition)?(O(this.definition)?this.definition.getter:this.definition).bind(void 0,this.parent.$this)():this.definition}analizeDeps(){let e=O(this.definition);("function"==typeof this.definition||e)&&(this.staticAnDeps=W(this.definition,e),o.log("Text Deps Analysis: ",this,this.staticAnDeps))}create(){var e,t,i,s,n,r,a;this.analizeDeps(),o.log("Text Node Created!"),null===(e=this.staticAnDeps.$this_deps)||void 0===e||e.forEach(e=>{let t=Array.isArray(e)?e[0]:e,i=this.parent.properties[t];if("addOnChangedHandler"in i)this.depsRemover.push(i.addOnChangedHandler(this,()=>this._renderizeText()));else if(t in this.parent.defDeps){var s,n,r,o,a,d;let i=this.parent.defDeps[t],h=this.parent;null===(s=i.$this_deps)||void 0===s||s.forEach(e=>{let t=Array.isArray(e)?e[0]:e,i=h.properties[t];"addOnChangedHandler"in i&&this.depsRemover.push(i.addOnChangedHandler(this,()=>this._renderizeText()))}),null===(n=i.$parent_deps)||void 0===n||n.forEach(e=>{let t=Array.isArray(e)?e[0]:e,i=h.parent.properties[t];"addOnChangedHandler"in i&&this.depsRemover.push(i.addOnChangedHandler(this,()=>this._renderizeText()))}),null===(r=i.$scope_deps)||void 0===r||r.forEach(t=>{let i=Array.isArray(t)?t[0]:t,[s,n]=h.get$ScopedPropsOwner(e),r=n?s.properties[i]:s.meta[i];"addOnChangedHandler"in r&&this.depsRemover.push(r.addOnChangedHandler(this,()=>this._renderizeText()))}),null===(o=i.$le_deps)||void 0===o||o.forEach(e=>{f(()=>{let t=e[1],i=h.$le[e[0]].properties[t];"addOnChangedHandler"in i&&this.depsRemover.push(i.addOnChangedHandler(this,()=>this._renderizeText()))},l,l,l,"Cannot connect to CLE Obj by Id",5,(e,t)=>{e||this._renderizeText()})}),null===(a=i.$ctx_deps)||void 0===a||a.forEach(e=>{f(()=>{let t=e[1],i=h.$ctx[e[0]].properties[t];"addOnChangedHandler"in i&&this.depsRemover.push(i.addOnChangedHandler(this,()=>this._renderizeText()))},l,l,l,"Cannot connect to CLE Obj by Ctx Id",5,(e,t)=>{e||this._renderizeText()})}),null===(d=i.$ref_deps)||void 0===d||d.forEach(e=>{f(()=>{let t=e[0],i=e[1],s=h.getChildsRefOwner(t).childsRefPointers[t];if(Array.isArray(s))throw Error("Cannot Bind to multi-ref child");let n=s.properties[i];"addOnChangedHandler"in n&&this.depsRemover.push(n.addOnChangedHandler(this,()=>this._renderizeText()))},l,l,l,"Cannot connect to CLE Obj by Ref Name",5,(e,t)=>{e||this._renderizeText()})})}}),null===(t=this.staticAnDeps.$parent_deps)||void 0===t||t.forEach(e=>{let t=Array.isArray(e)?e[0]:e,i=this.parent.parent.properties[t];if("addOnChangedHandler"in i)this.depsRemover.push(i.addOnChangedHandler(this,()=>this._renderizeText()));else if(t in this.parent.parent.defDeps){var s,n,r,o,a,d;let i=this.parent.parent.defDeps[t],h=this.parent.parent;null===(s=i.$this_deps)||void 0===s||s.forEach(e=>{let t=Array.isArray(e)?e[0]:e,i=h.properties[t];"addOnChangedHandler"in i&&this.depsRemover.push(i.addOnChangedHandler(this,()=>this._renderizeText()))}),null===(n=i.$parent_deps)||void 0===n||n.forEach(e=>{let t=Array.isArray(e)?e[0]:e,i=h.parent.properties[t];"addOnChangedHandler"in i&&this.depsRemover.push(i.addOnChangedHandler(this,()=>this._renderizeText()))}),null===(r=i.$scope_deps)||void 0===r||r.forEach(t=>{let i=Array.isArray(t)?t[0]:t,[s,n]=h.get$ScopedPropsOwner(e),r=n?s.properties[i]:s.meta[i];"addOnChangedHandler"in r&&this.depsRemover.push(r.addOnChangedHandler(this,()=>this._renderizeText()))}),null===(o=i.$le_deps)||void 0===o||o.forEach(e=>{f(()=>{let t=e[1],i=h.$le[e[0]].properties[t];"addOnChangedHandler"in i&&this.depsRemover.push(i.addOnChangedHandler(this,()=>this._renderizeText()))},l,l,l,"Cannot connect to CLE Obj by Id",5,(e,t)=>{e||this._renderizeText()})}),null===(a=i.$ctx_deps)||void 0===a||a.forEach(e=>{f(()=>{let t=e[1],i=h.$ctx[e[0]].properties[t];"addOnChangedHandler"in i&&this.depsRemover.push(i.addOnChangedHandler(this,()=>this._renderizeText()))},l,l,l,"Cannot connect to CLE Obj by Ctx Id",5,(e,t)=>{e||this._renderizeText()})}),null===(d=i.$ref_deps)||void 0===d||d.forEach(e=>{f(()=>{let t=e[0],i=e[1],s=h.getChildsRefOwner(t).childsRefPointers[t];if(Array.isArray(s))throw Error("Cannot Bind to multi-ref child");let n=s.properties[i];"addOnChangedHandler"in n&&this.depsRemover.push(n.addOnChangedHandler(this,()=>this._renderizeText()))},l,l,l,"Cannot connect to CLE Obj by Ref Name",5,(e,t)=>{e||this._renderizeText()})})}}),null===(i=this.staticAnDeps.$scope_deps)||void 0===i||i.forEach(e=>{let t=Array.isArray(e)?e[0]:e,[i,s]=this.parent.get$ScopedPropsOwner(t),n=s?i.properties[t]:i.meta[t];if("addOnChangedHandler"in n)this.depsRemover.push(n.addOnChangedHandler(this,()=>this._renderizeText()));else if(t in i.defDeps){var r,o,a,d,h,p;let s=i.defDeps[t];null===(r=s.$this_deps)||void 0===r||r.forEach(e=>{let t=Array.isArray(e)?e[0]:e,s=i.properties[t];"addOnChangedHandler"in s&&this.depsRemover.push(s.addOnChangedHandler(this,()=>this._renderizeText()))}),null===(o=s.$parent_deps)||void 0===o||o.forEach(e=>{let t=Array.isArray(e)?e[0]:e,s=i.parent.properties[t];"addOnChangedHandler"in s&&this.depsRemover.push(s.addOnChangedHandler(this,()=>this._renderizeText()))}),null===(a=s.$scope_deps)||void 0===a||a.forEach(t=>{let s=Array.isArray(t)?t[0]:t,[n,r]=i.get$ScopedPropsOwner(e),o=r?n.properties[s]:n.meta[s];"addOnChangedHandler"in o&&this.depsRemover.push(o.addOnChangedHandler(this,()=>this._renderizeText()))}),null===(d=s.$le_deps)||void 0===d||d.forEach(e=>{f(()=>{let t=e[1],s=i.$le[e[0]].properties[t];"addOnChangedHandler"in s&&this.depsRemover.push(s.addOnChangedHandler(this,()=>this._renderizeText()))},l,l,l,"Cannot connect to CLE Obj by Id",5,(e,t)=>{e||this._renderizeText()})}),null===(h=s.$ctx_deps)||void 0===h||h.forEach(e=>{f(()=>{let t=e[1],s=i.$ctx[e[0]].properties[t];"addOnChangedHandler"in s&&this.depsRemover.push(s.addOnChangedHandler(this,()=>this._renderizeText()))},l,l,l,"Cannot connect to CLE Obj by Ctx Id",5,(e,t)=>{e||this._renderizeText()})}),null===(p=s.$ref_deps)||void 0===p||p.forEach(e=>{f(()=>{let t=e[0],s=e[1],n=i.getChildsRefOwner(t).childsRefPointers[t];if(Array.isArray(n))throw Error("Cannot Bind to multi-ref child");let r=n.properties[s];"addOnChangedHandler"in r&&this.depsRemover.push(r.addOnChangedHandler(this,()=>this._renderizeText()))},l,l,l,"Cannot connect to CLE Obj by Ref Name",5,(e,t)=>{e||this._renderizeText()})})}}),null===(s=this.staticAnDeps.$le_deps)||void 0===s||s.forEach(e=>{f(()=>{let t=e[1],i=this.parent.$le[e[0]].properties[t];if("addOnChangedHandler"in i)this.depsRemover.push(i.addOnChangedHandler(this,()=>this._renderizeText()));else if(t in this.parent.$le[e[0]].defDeps){var s,n,r,o,a,d;let i=this.parent.$le[e[0]].defDeps[t],h=this.parent.$le[e[0]];null===(s=i.$this_deps)||void 0===s||s.forEach(e=>{let t=Array.isArray(e)?e[0]:e,i=h.properties[t];"addOnChangedHandler"in i&&this.depsRemover.push(i.addOnChangedHandler(this,()=>this._renderizeText()))}),null===(n=i.$parent_deps)||void 0===n||n.forEach(e=>{let t=Array.isArray(e)?e[0]:e,i=h.parent.properties[t];"addOnChangedHandler"in i&&this.depsRemover.push(i.addOnChangedHandler(this,()=>this._renderizeText()))}),null===(r=i.$scope_deps)||void 0===r||r.forEach(t=>{let i=Array.isArray(t)?t[0]:t,[s,n]=h.get$ScopedPropsOwner(e),r=n?s.properties[i]:s.meta[i];"addOnChangedHandler"in r&&this.depsRemover.push(r.addOnChangedHandler(this,()=>this._renderizeText()))}),null===(o=i.$le_deps)||void 0===o||o.forEach(e=>{f(()=>{let t=e[1],i=h.$le[e[0]].properties[t];"addOnChangedHandler"in i&&this.depsRemover.push(i.addOnChangedHandler(this,()=>this._renderizeText()))},l,l,l,"Cannot connect to CLE Obj by Id",5,(e,t)=>{e||this._renderizeText()})}),null===(a=i.$ctx_deps)||void 0===a||a.forEach(e=>{f(()=>{let t=e[1],i=h.$ctx[e[0]].properties[t];"addOnChangedHandler"in i&&this.depsRemover.push(i.addOnChangedHandler(this,()=>this._renderizeText()))},l,l,l,"Cannot connect to CLE Obj by Ctx Id",5,(e,t)=>{e||this._renderizeText()})}),null===(d=i.$ref_deps)||void 0===d||d.forEach(e=>{f(()=>{let t=e[0],i=e[1],s=h.getChildsRefOwner(t).childsRefPointers[t];if(Array.isArray(s))throw Error("Cannot Bind to multi-ref child");let n=s.properties[i];"addOnChangedHandler"in n&&this.depsRemover.push(n.addOnChangedHandler(this,()=>this._renderizeText()))},l,l,l,"Cannot connect to CLE Obj by Ref Name",5,(e,t)=>{e||this._renderizeText()})})}},l,l,l,"Cannot connect to CLE Obj by Id",5,(e,t)=>{e||this._renderizeText()})}),null===(n=this.staticAnDeps.$ctx_deps)||void 0===n||n.forEach(e=>{f(()=>{let t=e[1],i=this.parent.$ctx[e[0]].properties[t];if("addOnChangedHandler"in i)this.depsRemover.push(i.addOnChangedHandler(this,()=>this._renderizeText()));else if(t in this.parent.$ctx[e[0]].defDeps){var s,n,r,o,a,d;let i=this.parent.$ctx[e[0]].defDeps[t],h=this.parent.$ctx[e[0]];null===(s=i.$this_deps)||void 0===s||s.forEach(e=>{let t=Array.isArray(e)?e[0]:e,i=h.properties[t];"addOnChangedHandler"in i&&this.depsRemover.push(i.addOnChangedHandler(this,()=>this._renderizeText()))}),null===(n=i.$parent_deps)||void 0===n||n.forEach(e=>{let t=Array.isArray(e)?e[0]:e,i=h.parent.properties[t];"addOnChangedHandler"in i&&this.depsRemover.push(i.addOnChangedHandler(this,()=>this._renderizeText()))}),null===(r=i.$scope_deps)||void 0===r||r.forEach(t=>{let i=Array.isArray(t)?t[0]:t,[s,n]=h.get$ScopedPropsOwner(e),r=n?s.properties[i]:s.meta[i];"addOnChangedHandler"in r&&this.depsRemover.push(r.addOnChangedHandler(this,()=>this._renderizeText()))}),null===(o=i.$le_deps)||void 0===o||o.forEach(e=>{f(()=>{let t=e[1],i=h.$le[e[0]].properties[t];"addOnChangedHandler"in i&&this.depsRemover.push(i.addOnChangedHandler(this,()=>this._renderizeText()))},l,l,l,"Cannot connect to CLE Obj by Id",5,(e,t)=>{e||this._renderizeText()})}),null===(a=i.$ctx_deps)||void 0===a||a.forEach(e=>{f(()=>{let t=e[1],i=h.$ctx[e[0]].properties[t];"addOnChangedHandler"in i&&this.depsRemover.push(i.addOnChangedHandler(this,()=>this._renderizeText()))},l,l,l,"Cannot connect to CLE Obj by Ctx Id",5,(e,t)=>{e||this._renderizeText()})}),null===(d=i.$ref_deps)||void 0===d||d.forEach(e=>{f(()=>{let t=e[0],i=e[1],s=h.getChildsRefOwner(t).childsRefPointers[t];if(Array.isArray(s))throw Error("Cannot Bind to multi-ref child");let n=s.properties[i];"addOnChangedHandler"in n&&this.depsRemover.push(n.addOnChangedHandler(this,()=>this._renderizeText()))},l,l,l,"Cannot connect to CLE Obj by Ref Name",5,(e,t)=>{e||this._renderizeText()})})}},l,l,l,"Cannot connect to CLE Obj by Ctx Id",5,(e,t)=>{e||this._renderizeText()})}),null===(r=this.staticAnDeps.$ref_deps)||void 0===r||r.forEach(e=>{f(()=>{let t=e[1],i=this.parent.getChildsRefOwner(e[0]).childsRefPointers[e[0]];if(Array.isArray(i))throw Error("Cannot Bind to multi-ref child");let s=i.properties[t];"addOnChangedHandler"in s?this.depsRemover.push(s.addOnChangedHandler(this,()=>this._renderizeText())):d.log("CLE Warning - function in ref in text as deps not supported at this time")},l,l,l,"Cannot connect to CLE Obj by Ref Name",5,(e,t)=>{e||this._renderizeText()})}),null===(a=this.staticAnDeps.$external_deps)||void 0===a||a.forEach(e=>{void 0!==e&&"addOnChangedHandler"in e&&this.depsRemover.push(e.addOnChangedHandler(this,()=>this._renderizeText()))}),this._renderizeText()}destroy(){var e;this.html_pointer_element.remove(),null===(e=this.depsRemover)||void 0===e||e.forEach(e=>e())}constructor(e,t){(0,s._)(this,"html_pointer_element",void 0),(0,s._)(this,"definition",void 0),(0,s._)(this,"parent",void 0),(0,s._)(this,"depsRemover",[]),(0,s._)(this,"staticAnDeps",{}),this.parent=e,this.definition=t}}class ee extends Q{setupMountPoint(e){this.html_mount_point=e}setupMode(e){this.insertion_mode=e}buildHtmlPointerElement(){if(this.html_pointer_element=document.createElement(this.htmlElementType),"append"===this.insertion_mode)this.html_mount_point.appendChild(this.html_pointer_element);else if("before"===this.insertion_mode)this.html_mount_point.before(this.html_pointer_element);else if("after"===this.insertion_mode)this.html_mount_point.after(this.html_pointer_element);else throw Error("Unsupported Subrender insertion mode!");this.html_pointer_element.setAttribute(this.t_uid,"")}static SubRendererComponentFactory(e,t,i,s=!1,n="append"){let r=()=>{let s=new ee(e,i,e.$le,e.$dbus);return s.setupMountPoint(t),s.setupMode(n),s.buildSkeleton(),s.create(),s};return s?r:r()}}class et extends Q{buildHtmlPointerElementAnchor(){this.html_pointer_element_anchor=document.createComment("le-if"),this.isMyParentHtmlRoot?this.parent.appendChild(this.html_pointer_element_anchor):this.parent.html_pointer_element.appendChild(this.html_pointer_element_anchor)}buildSkeleton(){this.buildHtmlPointerElementAnchor()}buildChildsSkeleton(){}buildHtmlPointerElement(){if(this.isObjComponent)this.html_pointer_element=document.createElement("leobj"),this.meta_options.hasViewChilds&&this.html_pointer_element_anchor.after(this.html_pointer_element);else if(this.isPlaceholderPointerComponent){this.html_pointer_element=document.createComment("cleptr"),this.html_pointer_element_anchor.after(this.html_pointer_element);return}else this.html_pointer_element=document.createElement(this.htmlElementType),this.html_pointer_element_anchor.after(this.html_pointer_element),a.log("Created after comment anchor!");this.html_pointer_element.setAttribute(this.t_uid,"")}_create(){a.log("Start recreating: ",this),super.defineAndRegisterId(),super.buildSkeleton(),super.buildChildsSkeleton(),super.create()}create(){this.buildPropertiesRef(),this.visible=new x(this.convertedDefinition.meta.if,h,(e,t,i)=>{a.log("set: ",e,t,i),e!==i._latestResolvedValue&&(e?this._create():this._destroy())},l,()=>this.$this,(e,t,i=[])=>{var s,n,r,o,d;let h=[];return a.log("LEIF - Calculating deps"),null===(s=t.$parent_deps)||void 0===s||s.forEach(t=>{var i;let s=null===(i=this.parent.properties[t])||void 0===i?void 0:i.addOnChangedHandler(e,()=>e.markAsChanged());s&&h.push(s)}),null===(n=t.$scope_deps)||void 0===n||n.forEach(t=>{var i;let[s,n]=this.get$ScopedPropsOwner(t),r=null===(i=n?s.properties[t]:s.meta[t])||void 0===i?void 0:i.addOnChangedHandler(e,()=>e.markAsChanged());r&&h.push(r)}),null===(r=t.$le_deps)||void 0===r||r.forEach(t=>{let i;f(()=>{i=this.$le[t[0]].properties[t[1]].addOnChangedHandler(e,()=>e.markAsChanged())},l,l,l,"Cannot connect to CLE Obj by Id",5),h.push((...e)=>i(...e))}),null===(o=t.$ctx_deps)||void 0===o||o.forEach(t=>{let i;f(()=>{i=this.$ctx[t[0]].properties[t[1]].addOnChangedHandler(e,()=>e.markAsChanged())},l,l,l,"Cannot connect to CLE Obj by Ctx Id",5),h.push((...e)=>i(...e))}),null===(d=t.$ref_deps)||void 0===d||d.forEach(t=>{let i;f(()=>{let s=this.getChildsRefOwner(t[0]).childsRefPointers[t[0]];if(Array.isArray(s))throw Error("Cannot Bind to multi-ref child");i=s.properties[t[1]].addOnChangedHandler(e,()=>e.markAsChanged())},l,l,l,"Cannot connect to CLE Obj by Ref Name",5),h.push(()=>i())}),null==i||i.forEach(t=>{let i=null==t?void 0:t.addOnChangedHandler(e,()=>e.markAsChanged());i&&h.push(i)}),h},!0),a.log("Last if condition: ",this,this.convertedDefinition.meta.if),this.visible.value&&this._create()}_destroy(){super.destroy()}destroy(){this.html_pointer_element_anchor.remove(),this.visible.destroy(!0),super.destroy()}constructor(...e){super(...e),(0,s._)(this,"visible",!1),(0,s._)(this,"html_pointer_element_anchor",void 0)}}class ei extends Q{buildHtmlPointerElement(){this.parentIterableView.buildChildHtmlPointerElement(this,this.iterableIndex,this.is_full_rebuild)}updateDataRerencesAndMeta(e,t,i,s,n=!0){this.iterableIndex=e,this.meta_config=t,Object.entries(this.meta).forEach(([e,t])=>{!(n&&e===this.meta_config.iterablePropertyIdentifier)&&t instanceof x&&(null==t||t.markAsChanged())}),void 0!==this.hooks.onUpdate&&this.hooks.onUpdate()}constructor(e,t,i,s,n,r,o,d,l){super(e,t,i,s),this.parentIterableView=n,this.iterableIndex=r,this.meta_config=o,this.meta_options=d,this.is_full_rebuild=l,this.meta[this.meta_config.iterablePropertyIdentifier]=new x(this.meta_config.value,h,e=>{a.log("META: push back value edit!"),this.meta_config.define_helper.iterable[this.meta_config.define_helper.index]=e,this.meta_options.metaPushbackAutomark&&this.meta_config.realPointedIterableProperty.markAsChanged(),this.signals[this.meta_config.iterablePropertyIdentifier+"Changed"].emit(e,this.meta[this.meta_config.iterablePropertyIdentifier]._latestResolvedValue)},h,()=>this.$this,h,!0),void 0!==this.meta_config.define&&Object.entries(this.meta_config.define).forEach(([e,t])=>{if(e in this.meta_config.define_helper){let i=t+"Changed";this.meta[t]=new x(()=>this.meta_config.define_helper[e],h,(e,s,n)=>{e!==s&&this.signals[i].emit(e,this.meta[t]._latestResolvedValue)},h,()=>this.$this,h,!0),this.signals[i]=new R(i,"stream => (newValue: any, oldValue: any) - meta property change signal")}else this.meta[e]=new x(t,h,()=>{throw Error("meta define variable cannot be setted")},h,[()=>this.parent.$this,()=>this.$this],h,!0);a.log("I have some 'define' inside meta!",this.meta,e,t,this.meta_config.define)});let p="_mark_"+this.meta_config.iterablePropertyIdentifier+"_as_changed";this.meta[p]=()=>this.meta[this.meta_config.iterablePropertyIdentifier].markAsChanged();let c=this.meta_config.iterablePropertyIdentifier+"Changed";this.signals[c]=new R(c,"stream => (newValue: any, oldValue: any) - property change signal"),a.log("before meta: ",this.$meta,this.parent.$meta,this.meta,this.parent.meta,this.parent),this.$meta=this.getMy$meta(),a.log("after meta: ",this.$meta,this.parent.$meta,this.meta,this.parent.meta,this.parent)}}class es{get$ScopedPropsOwner(e,t=0,i=!1,s=!1){if(0===t&&(i=this.meta_options.noMetaInScope),void 0===this.parent||!(this.parent instanceof Q))return[this,!0];if(0===t&&this.meta_options.noThisInScope)return this.parent.get$ScopedPropsOwner(e,t+1,i,s);if(e in this.properties||s&&e in this.signals)return[this,!0];if(!this.meta_options.isNewScope)return this.parent.get$ScopedPropsOwner(e,t+1,i,s);throw Error("Properties cannot be found in this scope..blocked scope?")}buildHtmlPointerElementAnchor(){this.html_pointer_element_anchor=document.createComment("le-for"),this.html_end_pointer_element_anchor=document.createComment("le-for-end"),this.isMyParentHtmlRoot?(this.parent.appendChild(this.html_pointer_element_anchor),this.parent.appendChild(this.html_end_pointer_element_anchor)):(this.parent.html_pointer_element.appendChild(this.html_pointer_element_anchor),this.parent.html_pointer_element.appendChild(this.html_end_pointer_element_anchor))}buildChildHtmlPointerElement(e,t,i){e.html_pointer_element=document.createElement(e.htmlElementType),i?this.html_end_pointer_element_anchor.before(e.html_pointer_element):0===t?this.html_pointer_element_anchor.after(e.html_pointer_element):this.childs[t-1].html_pointer_element.after(e.html_pointer_element),e.html_pointer_element.setAttribute(e.t_uid,"")}sortExistingChildsInDomAsChildsArrOrder(){let e;let t=function(e,t){t.parentNode.insertBefore(e,t.nextSibling)},i=this.html_pointer_element_anchor;this.childs.forEach((s,n)=>{0===n?t(s.html_pointer_element,i):t(s.html_pointer_element,e),e=s.html_pointer_element})}buildSkeleton(){this.buildHtmlPointerElementAnchor(),this.buildPropertiesRef()}buildPropertiesRef(){var e,t;this.properties.parent=null===(e=this.parent)||void 0===e?void 0:null===(t=e.$this)||void 0===t?void 0:t.this,this.$parent=this.parent instanceof Q?z(this.parent.properties):void 0,this.$scope=N(this),this.$this=M({parent:this.$parent,le:this.$le.proxy,scope:this.$scope,ctx:this.parent.$ctx.proxy,meta:this.parent.$meta})}detectChangesAndRebuildChilds(e,t){var i,s,n;let a=void 0!==this.meta_def.idComparer&&m(this.meta_def.idComparer)?this.meta_def.idComparer:(e,t)=>e!==t,d=void 0!==this.meta_def.subComparer&&m(this.meta_def.subComparer)?this.meta_def.subComparer:void 0,l=null!==(i=this.meta_def.full_optimized)&&void 0!==i?i:r.DEFAULTS.META.FULL_OPTIMIZED;if(l){let i=[...this.childs],n=[],r=[],l=(e,t,i)=>{for(let t=0;t<i.length;t++)if(!a(e,i[t].meta_config.value))return[!0,t];return[!1,void 0]};e.forEach((s,a)=>{let[d,h]=l(s,a,i);if(d)o.log("sorted!!",s,t,"-->",a),n.push(i.splice(h,1)[0]);else{o.log("new!!",s,a);let t=new ei(this.parent,this.real_iterable_definition,this.$le,this.$dbus,this,a,{realPointedIterableProperty:this.real_pointed_iterable_property,iterablePropertyIdentifier:this.iterablePropertyIdentifier,value:e[a],define:this.meta_def.define,define_helper:{index:a,first:0===a,last:a===e.length-1,length:e.length,iterable:e}},this.meta_options,!1);n.push(t),r.push(t)}}),i.forEach(e=>{o.log("destroied!!",e),e.destroy()}),o.log("OLD",this.childs),this.childs.splice(0,this.childs.length,...n),r.forEach(e=>{e.buildSkeleton()}),r.forEach(e=>{e.create()}),this.sortExistingChildsInDomAsChildsArrOrder(),o.log("NEW",this.childs),null===(s=this.iterableProperty.value)||void 0===s||s.forEach((e,t,i)=>{this.childs[t].updateDataRerencesAndMeta(t,{realPointedIterableProperty:this.real_pointed_iterable_property,iterablePropertyIdentifier:this.iterablePropertyIdentifier,value:e,define:this.meta_def.define,define_helper:{index:t,first:0===t,last:t===i.length-1,length:i.length,iterable:i}},a,d,!0)})}else{let i={},s=this.childs;for(let t=0;t<e.length;t++){let n=e[t];(void 0===s[t]||a(n,s[t].meta_config.value))&&(i[t]=n)}let r=[];for(let t in i){let i=parseInt(t),n=new ei(this.parent,this.real_iterable_definition,this.$le,this.$dbus,this,i,{realPointedIterableProperty:this.real_pointed_iterable_property,iterablePropertyIdentifier:this.iterablePropertyIdentifier,value:e[i],define:this.meta_def.define,define_helper:{index:i,first:0===i,last:i===e.length-1,length:e.length,iterable:e}},this.meta_options,!1);void 0===s[i]||s[i].destroy(),s[i]=n,n.buildSkeleton(),r.push(n)}if(e.length<t.length)for(let i=e.length;i<t.length;i++)s[i].destroy(),s.splice(i,1);r.forEach(e=>e.create()),null===(n=this.iterableProperty.value)||void 0===n||n.forEach((e,t,i)=>{this.childs[t].updateDataRerencesAndMeta(t,{realPointedIterableProperty:this.real_pointed_iterable_property,iterablePropertyIdentifier:this.iterablePropertyIdentifier,value:e,define:this.meta_def.define,define_helper:{index:t,first:0===t,last:t===i.length-1,length:i.length,iterable:i}},a,d,!0)})}}buildChildsSkeleton(e=!1,t){var i,s;e&&(this.meta_def.optimized||(null!==(i=this.meta_def.full_optimized)&&void 0!==i?i:r.DEFAULTS.META.FULL_OPTIMIZED))?this.detectChangesAndRebuildChilds(this.iterableProperty.value,t):(this._destroyChilds(),this.childs=(null===(s=this.iterableProperty.value)||void 0===s?void 0:s.map((e,t,i)=>new ei(this.parent,this.real_iterable_definition,this.$le,this.$dbus,this,t,{realPointedIterableProperty:this.real_pointed_iterable_property,iterablePropertyIdentifier:this.iterablePropertyIdentifier,value:e,define:this.meta_def.define,define_helper:{index:t,first:0===t,last:t===i.length-1,length:i.length,iterable:i}},this.meta_options,!0)))||[],this.childs.forEach(e=>e.buildSkeleton()),this.childs.forEach(e=>e.create()))}_destroyChilds(){this.childs.length>0&&(this.childs.map(e=>e.destroy()),this.childs=[])}_create(e=!1,t){a.log("start recreating: ",this),this.buildChildsSkeleton(e,t)}create(){this.iterablePropertyIdentifier=this.meta_def.forEach,this.iterableProperty=new x(this.meta_def.of,h,(e,t,i)=>{a.log("set iterable",e,t,i),void 0!==this.meta_def.comparer?this.meta_def.comparer(e,i._latestResolvedValue)&&this._create(!0,i._latestResolvedValue):e!==i._latestResolvedValue&&this._create(!0,i._latestResolvedValue)},l,()=>this.$this,(e,t,i=[])=>{var s,n,r,o,d;let h=[];return a.log("calculating deps"),null===(s=t.$parent_deps)||void 0===s||s.forEach(t=>{var i;let s=null===(i=this.parent.properties[t])||void 0===i?void 0:i.addOnChangedHandler(e,()=>e.markAsChanged());s&&h.push(s),this.real_pointed_iterable_property.markAsChanged=()=>{var e;null===(e=this.parent.properties[t])||void 0===e||e.markAsChanged()}}),null===(n=t.$scope_deps)||void 0===n||n.forEach(t=>{var i;let[s,n]=this.get$ScopedPropsOwner(t),r=null===(i=n?s.properties[t]:s.meta[t])||void 0===i?void 0:i.addOnChangedHandler(e,()=>e.markAsChanged());r&&h.push(r),this.real_pointed_iterable_property.markAsChanged=()=>{var e;null===(e=n?s.properties[t]:s.meta[t])||void 0===e||e.markAsChanged()}}),null===(r=t.$le_deps)||void 0===r||r.forEach(t=>{let i;f(()=>{i=this.$le[t[0]].properties[t[1]].addOnChangedHandler(e,()=>e.markAsChanged())},l,l,l,"Cannot connect to CLE Obj by Id",5),h.push((...e)=>i(...e)),this.real_pointed_iterable_property.markAsChanged=()=>{var e;null===(e=this.$le[t[0]].properties[t[1]])||void 0===e||e.markAsChanged()}}),null===(o=t.$ctx_deps)||void 0===o||o.forEach(t=>{let i;f(()=>{i=this.$ctx[t[0]].properties[t[1]].addOnChangedHandler(e,()=>e.markAsChanged())},l,l,l,"Cannot connect to CLE Obj by Ctx Id",5),h.push((...e)=>i(...e)),this.real_pointed_iterable_property.markAsChanged=()=>{var e;null===(e=this.$ctx[t[0]].properties[t[1]])||void 0===e||e.markAsChanged()}}),null===(d=t.$ref_deps)||void 0===d||d.forEach(t=>{let i;f(()=>{let s=this.getChildsRefOwner(t[0]).childsRefPointers[t[0]];if(Array.isArray(s))throw Error("Cannot Bind to multi-ref child");i=s.properties[t[1]].addOnChangedHandler(e,()=>e.markAsChanged())},l,l,l,"Cannot connect to CLE Obj by Ref Name",5),h.push(()=>i()),this.real_pointed_iterable_property.markAsChanged=()=>{this.getChildsRefOwner(t[0]).childsRefPointers[t[0]].properties[t[1]].markAsChanged()}}),null==i||i.forEach(t=>{let i=null==t?void 0:t.addOnChangedHandler(e,()=>e.markAsChanged());i&&h.push(i),this.real_pointed_iterable_property.markAsChanged=()=>{null==t||t.markAsChanged()}}),h},!0),a.log("last of condition: ",this,this.meta_def.of),this.iterableProperty.value.length>0&&this._create(!1,void 0)}destroy(){this._destroyChilds(),this.html_pointer_element_anchor.remove(),this.html_end_pointer_element_anchor.remove(),this.iterableProperty.destroy(!0)}constructor(e,t,i,n){var o,a,d,l,h,p;(0,s._)(this,"iterableProperty",void 0),(0,s._)(this,"iterablePropertyIdentifier",void 0),(0,s._)(this,"parent",void 0),(0,s._)(this,"$le",void 0),(0,s._)(this,"$dbus",void 0),(0,s._)(this,"oj_definition",void 0),(0,s._)(this,"real_iterable_definition",void 0),(0,s._)(this,"meta_def",void 0),(0,s._)(this,"properties",{}),(0,s._)(this,"signals",{}),(0,s._)(this,"$this",void 0),(0,s._)(this,"$parent",void 0),(0,s._)(this,"childs",[]),(0,s._)(this,"html_pointer_element_anchor",void 0),(0,s._)(this,"html_end_pointer_element_anchor",void 0),(0,s._)(this,"real_pointed_iterable_property",void 0),this.parent=e,this.$le=i,this.$dbus=n,this.oj_definition=t,this.meta_def=(t instanceof H?t.computedTemplate:t)[k(t)].meta,this.real_iterable_definition=t instanceof H?t.cloneWithoutMeta():v(t),this.meta_options={isNewScope:null===(o=this.meta_def)||void 0===o?void 0:o.newScope,noThisInScope:null===(a=this.meta_def)||void 0===a?void 0:a.noThisInScope,noMetaInScope:null===(d=this.meta_def)||void 0===d?void 0:d.noMetaInScope,hasViewChilds:null===(l=this.meta_def)||void 0===l?void 0:l.hasViewChilds,metaPushbackAutomark:null!==(p=null===(h=this.meta_def)||void 0===h?void 0:h.metaPushbackAutomark)&&void 0!==p?p:r.DEFAULTS.META.PUSHBACK_AUTOMARK},this.real_pointed_iterable_property={markAsChanged:()=>{}}}}let en=()=>{void 0===window._Caged_LE_Loaded&&(window._Caged_LE_Loaded={})},er=(e,{do_microwait:t,attr:i={},debug:s=!1}={})=>(en(),new Promise(function(n,r){if(void 0!==window._Caged_LE_Loaded[e]){a.log("css already loaded!"),void 0!==t?setTimeout(()=>{n(window._Caged_LE_Loaded[e])},t):n(window._Caged_LE_Loaded[e]);return}let o=document.createElement("link");o.setAttribute("rel","stylesheet"),o.setAttribute("href",e),Object.keys(i).map(e=>o.setAttribute(e,i)),o.onload=i=>{window._Caged_LE_Loaded[e]=o,s&&a.log("resolved!",i),o.LE_removeStyle=()=>{window._Caged_LE_Loaded[e].remove(),delete window._Caged_LE_Loaded[e]},void 0!==t?setTimeout(()=>{n(window._Caged_LE_Loaded[e])},t):n(window._Caged_LE_Loaded[e])},o.onerror=r,document.head.appendChild(o)})),eo=e=>{document.addEventListener("DOMContentLoaded",e)},ea=(e,t=!1,...i)=>(t||(e=e[0]),(e=(e=e.replaceAll("@m.","$.meta.").replaceAll("@s.","$.scope.").replaceAll("@p.","$.parent.").replaceAll("@t.","$.this.").replaceAll("@l.","$.le.").replaceAll("@c.","$.ctx.").replaceAll("@d.","$.dbus.").replaceAll("@","$.scope.")).replaceAll(":m:","$.meta.").replaceAll(":s:","$.scope.").replaceAll(":p:","$.parent.").replaceAll(":t:","$.this.").replaceAll(":l:","$.le.").replaceAll(":c:","$.ctx.").replaceAll(":d:","$.dbus.").replaceAll(":::","$.meta.").replaceAll("::","$.scope.")).includes("return")||e.startsWith("{"))?Function("$",...i,e):Function("$",...i,"return "+e),ed=(...e)=>(t,i=!1)=>ea(t,i,...e),el=new Proxy({},{get:(e,t,i)=>(e,...i)=>void 0===e&&0===i.length?{[t]:{}}:"string"==typeof e||"function"==typeof e?{[t]:0===i.length?e:[e,...i]}:{[t]:{...e,...i.length?{"":i}:{}}},set:function(e,t,i){}}),eh=new Proxy({},{get:(e,t,i)=>t,set:function(e,t,i){}}),ep=new Proxy({},{get:(e,t,i)=>t.replaceAll("_"," "),set:function(e,t,i){}}),ec=(e,t)=>({["let_"+e]:t}),eu=(e,t,i="")=>e?" "+t:i,em={beforeinit:"beforeInit",oninit:"onInit",afterchildsinit:"afterChildsInit",afterinit:"afterInit",ondestroy:"onDestroy",onupdate:"onUpdate",constructor:"constructor"},e_=(e,t,i,s)=>{if(8!==e.nodeType){if("#text"===e.nodeName){let t=e.textContent;return/^\s*$/.test(t)?void 0:t.includes("{{")&&t.includes("}}")?(function(e){let t=/{{(.*?)}}/g;[...e.matchAll(t)].sort((e,t)=>e.index-t.index);let i=[],s=0;for(let n of e.matchAll(t)){let t=n.index,r=n[0],o=n[1],a={index:t,text:o,match:!0};if(s<t){let n=e.slice(s,t);i.push({index:s,text:n,match:!1})}i.push(a),s=t+r.length}if(s<e.length){let t=e.slice(s);i.push({index:s,text:t,match:!1})}return i})(t).map(e=>e.match?ea(e.text,!0):e.text):t}{let n,r=e.tagName.toLowerCase();if("js-val"===r)return ed("Cle","params","state","DepsInj","u")(Array.from(e.childNodes)[0].textContent,!0)(void 0,eP,s.params,s.state,s.DepsInj,s.u);let a={},d={},l={},h={},p={},c={},m={},_={},f={},v={},g={},C={},y={};for(let t of e.attributes||[])if("extra-defs"===t.name)n=t.value;else if("[use-options]"===t.name)y=ea(t.value,!0)(),o.log("USE OPTIONS: ",y);else if("[raw-defs]"===t.name)C=ea(t.value,!0)(),o.log("RAW DEFS: ",C);else if(t.name.startsWith("[raw-def-")){let e=u(t.name.substring(9,t.name.length-1));C={...C,[e]:ea(t.value,!0)()},o.log("RAW DEF BY KEY:",e,C)}else if(t.name.startsWith("#"))"#id"===t.name?g.id=t.value:"#ctx_id"===t.name||"#ctx-id"===t.name?g.ctx_id=t.value:"#ctx_ref_id"===t.name||"#ctx-ref-id"===t.name?g.ctx_ref_id=t.value:"#name"===t.name?g.name=t.value:console.log("UNSUPPORTED AT THIS TIME: ",t);else if(t.name.startsWith("meta-")||t.name.startsWith("[meta-")&&t.name.endsWith("]")){let e=t.name.startsWith("[")?t.name.substring(6,t.name.length-1):t.name.substring(5);if("foreach"===e){let[e,i]=t.value.split(" of ");f.forEach=e,f.of=ea(i,!0)}else"if"===e?f.if=ea(t.value,!0):"optimized"===e?f.optimized="true"===t.value:"full_optimized"===e||"full-optimized"===e?f.full_optimized="true"===t.value:"comparer"===e?f.comparer=ea(t.value,!0):"idcomparer"===e||"id-comparer"===e?f.idComparer=ea(t.value,!0):e.startsWith("define-")?(e=u(e.substring(7)),void 0===f.define&&(f.define={}),f.define[e]=t.value):console.log("UNSUPPORTED AT THIS TIME: ",t)}else if(t.name.startsWith("hook-"))v[em[t.name.substring(5)]]=ea(t.value,!0);else if(t.name.startsWith("[hook-")&&t.name.endsWith("]"))v[em[t.name.substring(6,t.name.length-1)]]=ea(t.value,!0);else if(t.name.startsWith("signal-"))d["signal_"+u(t.name.substring(7))]=t.value||"stream => void";else if(t.name.startsWith("(on-")&&t.name.endsWith("-changed)")){let e=u(t.name.substring(4,t.name.length-9)),i=ed("newValue","oldValue")(t.value,!0);l["on_"+e+"Changed"]=i}else if(t.name.startsWith("(on-dbus-")){let e=u(t.name.substring(9,t.name.length-1)),i=ed("$val","$val1","$val2","$val3","$val4","$val5","$val6","$val7","$val8","$val9")(t.value,!0);l["on_dbus_"+e]=i}else if(t.name.startsWith("(on-")){let e=u(t.name.substring(4,t.name.length-1)),i=ed("$val","$val1","$val2","$val3","$val4","$val5","$val6","$val7","$val8","$val9")(t.value,!0);l["on_"+e]=i}else if(t.name.startsWith("(")){let e=t.name.substring(1,t.name.length-1),i=ed("evt")(t.value,!0);_["h_"+e]=i}else if(t.name.startsWith("let-raw")||t.name.startsWith("set-raw-"))a[u(t.name.substring(8))]=t.value;else if(t.name.startsWith("[let-raw")||t.name.startsWith("[set-raw-"))a[u(t.name.substring(9,t.name.length-1))]=ea(t.value,!0);else if(t.name.startsWith("let-")||t.name.startsWith("set-"))a["let_"+u(t.name.substring(4))]=t.value;else if(t.name.startsWith("[let-")||t.name.startsWith("[set-"))a["let_"+u(t.name.substring(5,t.name.length-1))]=ea(t.value,!0);else if(t.name.startsWith("[ha-")){let e=t.name.substring(4,t.name.length-1);e.includes("-")&&(e=e.split(".").map(e=>e.split("-").map((e,t)=>0===t?e:e.charAt(0).toUpperCase()+e.substring(1)).join("")).join("."));let i=ea(t.value,!0);m["ha_"+e]=i}else if(t.name.startsWith("ha-"))c["ha_"+u(t.name.substring(3))]=t.value;else if(t.name.startsWith("[")){let e=t.name.substring(1,t.name.length-1),i=ea(t.value,!0);p["a_"+e]=i}else h["a_"+t.name]=t.value;let b={...g,...h,...p,...c,...m,..._,...v,...a,...d,...l,...f?{meta:f}:{},...C,...void 0!==n&&n in i?i[n]:{}},E=Array.from(e.childNodes).flatMap(e=>e_(e,t,i,s)).filter(e=>void 0!==e);if(r.startsWith("use-")){if(r.substring(4).toLowerCase() in t)return w(t[r.substring(4).toLowerCase()],{...b},{...y},E);if(eH.has(r))return eH.get(r)({...b},{...y},...E)}else if(r.startsWith("extended-")){if(r.substring(9).toLowerCase() in t)return P(t[r.substring(9).toLowerCase()],{...b},{...y},E);if(eH.has(r))return eH.get(r)({...b},{...y},...E)}else if(r.startsWith("component-")&&eH.has(r))return eH.get(r)({...b},...E);return{[r]:{...b,"=>":E}}}}},ef=(e,t={},i={},s={},n={params:{},state:{},DepsInj:{},u:{}})=>{let r=new DOMParser,o=r.parseFromString(e,"text/html").body,a={};if(0===o.childNodes.length)throw Error("No html found");{i=Object.fromEntries(Object.entries(i).map(([e,t])=>[e.toLowerCase(),t]));let e=Array.from(o.childNodes).flatMap(e=>e_(e,i,s,n)).filter(e=>void 0!==e);if(1===e.length){let i=Object.keys(e[0])[0];a={[i]:{...t,...e[0][i]}}}else a={multi:{...t,"=>":e}}}return a},ev=(async function(){}).constructor,eg=(e,t)=>void 0!==t&&""!==t&&e.toUpperCase().includes("</"+t.toUpperCase()+">")?2:1,eC=(e,t,i="view")=>{var s,n,r;let o=RegExp("\\s*<"+i+(""!==t?" "+t:"")+">([\\s\\S]*?)<\\/"+i+">","gi"),a=RegExp("\\s*<style"+(""!==t?" "+t:"")+">([\\s\\S]*?)<\\/style>","gi"),d=RegExp("\\s*<script"+(""!==t?" "+t:"")+">([\\s\\S]*?)<\\/script>","gi");return{viewContent:null===(s=o.exec(e))||void 0===s?void 0:s[1],styleContent:null===(n=a.exec(e))||void 0===n?void 0:n[1],defContent:null===(r=d.exec(e))||void 0===r?void 0:r[1]}},ey=(e,t)=>{var i;let s=RegExp("\\s*<"+t+"\\b[^>]*>([\\s\\S]*?)<\\/"+t+">","gi"),n=null===(i=s.exec(e))||void 0===i?void 0:i[1];return{...eC(n,"",n.includes("<_>")?"_":n.includes("<template>")?"template":"view")}},eb=async(e,{component:t="",params:i={},state:s={},DepsInj:n={},externalDef:o}={})=>{let a={localComponent:(t,{params:i={},state:s={},DepsInj:n={},externalDef:r}={})=>eb(e,{component:t,params:i,state:s,DepsInj:n,externalDef:r}),localComponents:async t=>{let i={};for(let[s,n]of Object.entries(t))i[s]=await eb(e,{component:s,...null!=n?n:{}});return i}},d=eg(e,t),{viewContent:l,styleContent:h,defContent:p}=1===d?eC(e,t):ey(e,t),c={},u=1===d?{}:{autostyle:r.REMOTE_HTML_V2_AUTOSTYLE};if(p||o){p&&!p.includes("return")&&(p="return ( "+p+" )");let e=o||new ev("Cle","params","state","style","DepsInj","u",p);if(void 0!==h){let e=h;h=Object.assign(e,{setup:(t={})=>{let i=e;return Object.entries(t).forEach(([e,t])=>{i=i.replaceAll(e,t)}),i}})}let t=await e(eP,i,s,h,n,a);void 0!==t&&(Array.isArray(t)?(c=t[0],t.length>=2&&(u={...u,...t[1]})):c=t)}if(!l)throw Error("No View Found");return void 0!==h&&!0===u.autostyle&&void 0===c.css&&(void 0!==h.setup?c.css=[$=>h.setup("cssVars"in $.this?$.this.cssVars:{})]:c.css=[h]),ef(l,c,u.deps,u.extraDefs,{params:i,state:s,DepsInj:n,u:a})},eE=new Map,e$=async(e,{component:t="",params:i={},state:s={},DepsInj:n={},autoExtension:r=!0,cache:o=!0,externalDef:a}={})=>{r&&(e+=e.endsWith(".html")?"":".html");try{let r;if(o&&eE.has(e))r=eE.get(e);else{let t=await fetch(e);if(!t.ok)throw console.log(t),Error("REMOTE HTML REF ERROR");r=await t.text(),o&&eE.set(e,r)}return eb(r,{component:t,params:i,state:s,DepsInj:n,externalDef:a})}catch(e){throw Error("REMOTE HTML REF ERROR: "+e)}},eO=async(e,...t)=>{let i={};for(let s of t)i["string"==typeof s?{component:s}:s]=await e$(e);return i},ex=async(e,{component:t="",params:i={},state:s={},DepsInj:n={},def:r}={})=>await eb(e,{component:t,params:i,state:s,DepsInj:n,externalDef:r}),eR=(e,{component:t,isRemote:i=!0,autoExtension:s=!0,cache:n=!0,def:r,defArgMapper:o=async(e={},t={},i={})=>({params:e,state:t,DepsInj:i})})=>async(a={},d={},l={})=>{var h,p,c,u,m,_;let f=await o(a,d,l);return i?e$(e,{component:t,params:null!==(h=f.params)&&void 0!==h?h:a,state:null!==(p=f.state)&&void 0!==p?p:d,DepsInj:null!==(c=f.DepsInj)&&void 0!==c?c:l,autoExtension:s,cache:n,externalDef:r}):eb(e,{component:t,params:null!==(u=f.params)&&void 0!==u?u:a,state:null!==(m=f.state)&&void 0!==m?m:d,DepsInj:null!==(_=f.DepsInj)&&void 0!==_?_:l,externalDef:r})},eA=async(e={})=>{let t=Object.entries(e).map(([e,t])=>({name:e,depImporterPromise:t instanceof Promise?t:t[0],postProcessing:t instanceof Promise?e=>e:t[1]}));return Object.fromEntries((await Promise.all(t.map(e=>e.depImporterPromise))).map((e,i)=>[t[i].name,t[i].postProcessing(e)]))},ew=async(e={})=>{let t=Object.entries(e).map(([e,t])=>({name:e,depImporterPromise:t instanceof Promise?t:t[0],postProcessing:t instanceof Promise?e=>e:t[1]})),i=Object.fromEntries((await Promise.all(t.map(e=>e.depImporterPromise))).map((e,i)=>[t[i].name,t[i].postProcessing(e)]));return void 0===window.globalCleImports?window.globalCleImports=i:window.globalCleImports={...window.globalCleImports,...i}},eH=new class{define(e,t=r.COMPONENT_REGISTRY_BASE_HTML_EL,i=!1){let s=k(e),n=e[s],o={[null!=t?t:s]:n},a=s.toLowerCase();if(!i&&void 0!==this.components["component_"+a])throw Error("Components Registry - Redefiniton Error");this.components["component_"+a]=this.components["component-"+a]=(e={},...i)=>{let r=n;if("function"==typeof r&&(r=r(e),e=(null==e?void 0:e.extra_use_args)!==void 0?null==e?void 0:e.extra_use_args:{}),void 0===e||"object"!=typeof r)return{[null!=t?t:s]:r};{let n={},o={},a=T(r);null!==a&&(n={[a]:[...r[a],...i]});let d=T(e);return null!==d&&(o={[d]:[...e[d],...i]}),{[null!=t?t:s]:{...r,...n,...e,...o}}}},this.components["use_"+a]=this.components["use-"+a]=(e,i,...r)=>{let a=n,d=o;return"function"==typeof a&&(d={[null!=t?t:s]:a=a(e)},e=(null==e?void 0:e.extra_use_args)!==void 0?null==e?void 0:e.extra_use_args:{}),w(d,e,i,r)},this.components["extended_"+a]=this.components["extended-"+a]=(e,i,...r)=>{let a=n,d=o;return"function"==typeof a&&(d={[null!=t?t:s]:a=a(e)},e=(null==e?void 0:e.extra_use_args)!==void 0?null==e?void 0:e.extra_use_args:{}),P(d,e,i,r)}}has(e){return e.toLowerCase() in this.components}get(e){return this.components[e.toLowerCase()]}remove(e){let t=e.toLowerCase();delete this.components["component_"+t],delete this.components["component-"+t],delete this.components["use_"+t],delete this.components["use-"+t],delete this.components["extended_"+t],delete this.components["extended-"+t]}reset(){this.components={}}constructor(){this.components={}}},eP={CLE_FLAGS:r,pass:l,none:h,smart:(e,t={})=>Object.entries(e).map(([e,i])=>({[e]:{text:i,...t}}))[0],f:ea,fArgs:ed,asFunc:e=>$=>e.bind(void 0,$),Use:w,Extended:P,Placeholder:D,Bind:G,Alias:(e=()=>{},t=()=>{},i=()=>{},s,n,r)=>new g(e,t,i,s,n,r),SmartAlias:C,PropertyBinding:C,DefineSubprops:y,ExternalProp:(e,t)=>new x(e,h,t||h,h,h,h,h,!0),useExternal:E,BindToProp:e=>new S(e),Switch:(...e)=>e,Case:(e,t)=>{let i=k(t),{meta:s,...n}=t[i];return{[i]:{meta:{if:e},...n}}},LazyComponent:(e,t,i={},s,n=(e,t)=>e!==t)=>void 0===s?{LazyPointer:{...i,renderizedComponent:void 0,afterInit:async $=>{let i=e;"function"==typeof e&&(i=await e($,t)),$.renderizedComponent=$.u.newConnectedSubRenderer($.this.el,i,!1,"after")}}}:{LazyPointer:{...i,renderizedComponent:void 0,inRendering:!1,rerenderingDeps:s,on_this_rerenderingDepsChanged:($,e,t)=>{n(e,t)&&void 0!==$.renderizedComponent&&!$.inRendering&&($.renderizedComponent.destroy(),$.renderize())},def_renderize:async $=>{o.log("renderizing.."),$.inRendering=!0;let i=e;"function"==typeof e&&(i=await e($,t)),$.renderizedComponent=$.u.newConnectedSubRenderer($.this.el,i,!1,"after"),o.log("renderized",$.renderizedComponent),$.inRendering=!1},afterInit:async $=>{await $.renderize()}}},UseShadow:(e,t={},i=!0,s=[],n="div",r=!1)=>({[n]:{...t,renderizedComponent:void 0,shadowRoot:void 0,afterInit:async $=>{$.shadowRoot=$.this.el.attachShadow({mode:r?"open":"closed"}),$.renderizedComponent=$.u.newConnectedSubRenderer($.shadowRoot,i?w(e,...s):e)},onDestroy:$=>{$.renderizedComponent.destroy()}}}),RenderApp:q,toInlineStyle:c,LE_LoadScript:(e,{do_microwait:t,attr:i={},scriptDestructor:s=()=>{},debug:n=!1}={})=>(en(),new Promise(function(r,o){if(void 0!==window._Caged_LE_Loaded[e]){n&&a.log("js already loaded!"),void 0!==t?setTimeout(()=>{r(window._Caged_LE_Loaded[e])},t):r(window._Caged_LE_Loaded[e]);return}let d=document.createElement("script");d.onload=i=>{window._Caged_LE_Loaded[e]=d,d.LE_removeScript=()=>{window._Caged_LE_Loaded[e].remove(),s(),delete window._Caged_LE_Loaded[e]},n&&a.log("resolved!",i),void 0!==t?setTimeout(()=>{r(window._Caged_LE_Loaded[e])},t):r(window._Caged_LE_Loaded[e])},d.onerror=o,d.setAttribute("src",e),Object.keys(i).map(e=>d.setAttribute(e,i)),document.head.appendChild(d)})),LE_LoadCss:er,LE_InitWebApp:eo,LE_BackendApiMock:class{response(e){return new Promise((t,i)=>{setTimeout(()=>t(JSON.parse(JSON.stringify(e))),this.apiSpeed)})}failResponse(e){return new Promise((t,i)=>{setTimeout(()=>i(JSON.parse(JSON.stringify(e))),this.apiSpeed)})}request(e){if(void 0!==e)return JSON.parse(JSON.stringify(e))}get(e,t){return this.response(this.services[e](this.request(t)))}post(e,t){return this.response(this.services[e](this.request(t)))}put(e,t){return this.response(this.services[e](this.request(t)))}constructor(e=100){this.services={},this.apiSpeed=e}},cle:el,str:eh,str_:ep,input:ec,output:(e,t="stream => void")=>({["s_"+e]:t}),ExtendSCSS:j,clsIf:eu,html:ef,remoteHtmlComponent:e$,remoteHtmlComponents:eO,fromHtmlComponentDef:ex,defineHtmlComponent:eR,defineHtmlComponents:(e,...t)=>Object.fromEntries(t.map(t=>[t.component,eR(e,t)])),importAll:eA,globalImportAll:ew,ComponentsRegistry:eH}}),n.register("OHGR1",function(t,i){e(t.exports,"_",function(){return s});function s(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}});